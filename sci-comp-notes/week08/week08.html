<!DOCTYPE html>  
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>week08</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
body{-webkit-font-smoothing:antialiased;font-family:"Helvetica Neue",Helvetica,Arial,Verdana,sans-serif;margin:30px 0 0;padding:0;background:#fff}#wrapper{padding:20px}li{font-size:110%}li li{font-size:100%}li p{font-size:100%;margin:.5em 0}h1{color:#000}h2{color:#111}h3{color:#111;margin:0}h4{color:#111}h5{color:#111}h6{font-size:1em;line-height:1.5em;margin:1.5em 0}body,p,td,div{color:#111;font-family:"Helvetica Neue",Helvetica,Arial,Verdana,sans-serif;word-wrap:break-word}a{color:#0d6ea1;text-decoration:none;-webkit-transition:color 0.2s ease-in-out;-moz-transition:color 0.2s ease-in-out;-o-transition:color 0.2s ease-in-out;-ms-transition:color 0.2s ease-in-out;transition:color 0.2s ease-in-out}a:hover{color:#3593d9}body{font-size:15px;line-height:21px;margin:0 auto}h1{font-size:37px;line-height:42px;margin-top:42px;margin-bottom:21px}h2{font-size:27px;line-height:42px;margin-top:42px;margin-bottom:21px}h3{font-size:20px;line-height:21px;margin-top:21px;margin-bottom:21px}h4{font-size:20px;line-height:21px;margin-top:21px;margin-bottom:21px}p,ul,ol,pre,table,blockquote{margin-top:21px;margin-bottom:21px}hr{border:1px solid;margin:-1px 0}ul ul,ol ol,ul ol,ol ul{margin-top:0;margin-bottom:0}b,strong,em,small,code{line-height:1}.footnote{color:#0d6ea1;font-size:.8em;vertical-align:super}#wrapper img{max-width:100%;height:auto}dd{font-size:1em;margin-bottom:1em}li>p:first-child{margin:0}ul ul,ul ol{margin-bottom:.4em}caption,col,colgroup,table,tbody,td,tfoot,th,thead,tr{border-spacing:0}table{border:1px solid rgba(0,0,0,0.25);border-collapse:collapse;display:table;empty-cells:hide;margin:-1px 0 1.3125em;padding:0;table-layout:fixed}caption{display:table-caption;font-weight:700}col{display:table-column}colgroup{display:table-column-group}tbody{display:table-row-group}tfoot{display:table-footer-group}thead{display:table-header-group}td,th{display:table-cell}tr{display:table-row}table th,table td{font-size:1.1em;line-height:23px;padding:0 1em}table thead{background:rgba(0,0,0,0.15);border:1px solid rgba(0,0,0,0.15);border-bottom:1px solid rgba(0,0,0,0.2)}table tbody{background:rgba(0,0,0,0.05)}table tfoot{background:rgba(0,0,0,0.15);border:1px solid rgba(0,0,0,0.15);border-top:1px solid rgba(0,0,0,0.2)}figure{display:inline-block;overflow:hidden;position:relative;margin:1em 0 2em}figcaption{font-style:italic;text-align:center;background:white;color:#666}.poetry pre{display:block;font-family:Georgia,Garamond,serif !important;font-size:110% !important;font-style:italic;line-height:1.6em;margin-left:1em}.poetry pre code{font-family:Georgia,Garamond,serif !important;word-break:break-all;word-break:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;white-space:pre-wrap}blockquote p{font-size:110%;font-style:italic;line-height:1.6em}sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;position:relative;vertical-align:super}sub{vertical-align:sub;top:-1px}p,h5{font-size:1.1429em;line-height:1.3125em;margin:1.3125em 0}dt,th{font-weight:700}table tr:nth-child(odd),table th:nth-child(odd),table td:nth-child(odd){background:rgba(255,255,255,0.06)}table tr:nth-child(even),table td:nth-child(even){background:rgba(200,200,200,0.25)}@media print{body{font-size:13px !important}img,table,figure{page-break-inside:avoid}#wrapper{background:#fff;color:#303030;padding:10px;position:relative;text-indent:0}}@media screen{.inverted{background:#252a2a}.inverted #wrapper{background:#252a2a;color:#eee}.inverted hr{border-color:#333f40 !important}.inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted th,.inverted .math,.inverted caption,.inverted dt,.inverted dd{color:#eee}.inverted pre{background:#ccc}.inverted pre code{color:#111}.inverted table{background:none}.inverted table tr:nth-child(odd),.inverted table td:nth-child(odd){background:none}.inverted a{color:#acd1d5}::selection{background:rgba(157,193,200,0.5)}h1::selection{background-color:rgba(45,156,208,0.3)}h2::selection{background-color:rgba(90,182,224,0.3)}h3::selection,h4::selection,h5::selection,h6::selection,li::selection,ol::selection{background-color:rgba(133,201,232,0.3)}code::selection{background-color:rgba(0,0,0,0.7);color:#eee}code span::selection{background-color:rgba(0,0,0,0.7) !important;color:#eee !important}a::selection{background-color:rgba(255,230,102,0.2)}.inverted a::selection{background-color:rgba(255,230,102,0.6)}td::selection,th::selection,caption::selection{background-color:rgba(180,237,95,0.5)}}

@media print{
#generated-toc-clone,#generated-toc{display:none!important}
}
#generated-toc-clone li.missing,#mkreplaced-toc li.missing{list-style-type:none!important}#generated-toc-clone li, #mkreplaced-toc li{list-style-type:upper-roman}#generated-toc-clone li li, #mkreplaced-toc li li{list-style-type:decimal}#generated-toc-clone li li li,#mkreplaced-toc li li li{list-style-type:decimal-leading-zero}#generated-toc-clone li li li li,#mkreplaced-toc li li li li{list-style-type:lower-greek}#generated-toc-clone li li li li li,#mkreplaced-toc li li li li li{list-style-type:disc}#generated-toc-clone li li li li li li,#mkreplaced-toc li li li li li li{list-style-type:square}
</style>

</head>
<body class="normal firstload">
  <div id="wrapper">
      <h1 id="week8notes">Week 8 Notes</h1>

<p>These are the notes for week 8 of Math 3001. <a href="../index.html">Return to all notes</a></p>

<h2 id="maximumandminimumproblems">Maximum and Minimum Problems</h2>

<p>Another huge part of Scientific Computing is those of Extrema problems (maxima and minima). You may recall just problems from Calculus in which you seek the smallest or largest value of a function (on some subdomain or the entire domain of the function). We&#8217;ll start with such problems. </p>

<p>Find the minimum and maximum of <span class="math">\(f(x)=7x^{3}+80x^{2}-300x-40\)</span> on the interval [&#8211;10,10]. For this, recall that the maximum and minima occur where the derivative is 0 (or undefined). So we search on the interval [&#8211;10,10] for places where the derivative is 0. Note: this is just Newton&#8217;s method for the function <span class="math">\(f'(x)\)</span>.</p>

<p>There are two such places for the derivative to be zero, about 1.55 and &#8211;9.18. Recall that max and mins can also occur on the endpoints. So we check the function value at all of these points:</p>
<pre><code class="(null)">f(10)=11960
f(-10)=3960
f(1.55)=-286.73819204421756
f(-9.18) = 4040.4494543269093</code></pre>

<p>so the absolute minimum is &#8211;286.74 (about x=1.55) and the absolute max is 11960 at x=10. </p>

<h3 id="extremaproblemsoffunctionofmorethanonevariable">Extrema Problems of function of more than one variable</h3>

<p>I want to point out that most functions that people are interested in finding max or mins of are of more than one variable. There are techniques to solve these and some of these are addressed in Calculus IV or you can look at a text on Vector Calculus. Because these are beyond the scope of these problems, I won&#8217;t address them here. </p>

<h2 id="otherextremaproblems">Other Extrema Problems</h2>

<p>There are a lot of extrema problems that don&#8217;t fit nicely as finding the extrema of a smooth function of some number of variables. We&#8217;ll spend the rest of this week looking at those. </p>

<h3 id="thetravelingsalespersonproblem">The Traveling Salesperson Problem</h3>

<p>A classic example of a minimum problem is that of the <a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem">traveling salesperson problem</a> or TSP. The problem goes like this: a salesperson needs to visit N cities on her route. There is a known distance between all pairs of the cities. What is the path she should take to minimize the total distance. </p>

<p>Although such a problem may seem a bit archaic (at least the name is). There are many problems that fit into this and in fact, when you use a mapping program to find the shortest route somewhere, at some level, there is a TSP in there somewhere. </p>

<p>Here&#8217;s how it goes. The following in a complete graph in that 1) the graph is a set of nodes and edges that connect the nodes. 2) it is complete because any nodes is connected to all other nodes:</p>

<figure>
<img src="http://upload.wikimedia.org/wikipedia/commons/thumb/c/cf/Complete_graph_K5.svg/200px-Complete_graph_K5.svg.png" alt="K5 Complete Graph" />
<figcaption>K5 Complete Graph</figcaption>
</figure>

<p>Let&#8217;s say that the nodes are labelled from A (top) clockwise to E (upper left). And then the distances between the nodes (also called the weights) are given by the following table:</p>

<table>
<colgroup>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
<col style="text-align:left;"/>
</colgroup>

<thead>
<tr>
	<th style="text-align:left;">Node 1</th>
	<th style="text-align:left;">Node 2</th>
	<th style="text-align:left;">Distance</th>
</tr>
</thead>

<tbody>
<tr>
	<td style="text-align:left;">A</td>
	<td style="text-align:left;">B</td>
	<td style="text-align:left;">26</td>
</tr>
<tr>
	<td style="text-align:left;">A</td>
	<td style="text-align:left;">C</td>
	<td style="text-align:left;">19</td>
</tr>
<tr>
	<td style="text-align:left;">A</td>
	<td style="text-align:left;">D</td>
	<td style="text-align:left;">39</td>
</tr>
<tr>
	<td style="text-align:left;">A</td>
	<td style="text-align:left;">E</td>
	<td style="text-align:left;">23</td>
</tr>
<tr>
	<td style="text-align:left;">B</td>
	<td style="text-align:left;">C</td>
	<td style="text-align:left;">13</td>
</tr>
<tr>
	<td style="text-align:left;">B</td>
	<td style="text-align:left;">D</td>
	<td style="text-align:left;">21</td>
</tr>
<tr>
	<td style="text-align:left;">B</td>
	<td style="text-align:left;">E</td>
	<td style="text-align:left;">42</td>
</tr>
<tr>
	<td style="text-align:left;">C</td>
	<td style="text-align:left;">D</td>
	<td style="text-align:left;">32</td>
</tr>
<tr>
	<td style="text-align:left;">C</td>
	<td style="text-align:left;">E</td>
	<td style="text-align:left;">25</td>
</tr>
<tr>
	<td style="text-align:left;">D</td>
	<td style="text-align:left;">E</td>
	<td style="text-align:left;">17</td>
</tr>
</tbody>
</table>

<p>Again, the question is: What path through all of the nodes leads to the smallest total distance. For example, if we choose A-&gt;B-&gt;C-&gt;D-&gt;E-&gt;A, the the total distance is 26+13+32+17+23=111</p>

<h3 id="exhaustivesolutionorbruteforce">Exhaustive Solution (or Brute Force)</h3>

<p>In this case, there aren&#8217;t that many total paths. With 5 nodes, there are a total Â 24 different paths and that&#8217;s not too difficult to traverse. Let&#8217;s look on how to do this in Julia.</p>

<p>First, let&#8217;s put the distances into an array:</p>
<pre><code class="(null)">distances5=
[0 26 19 39 23; 
26 0 13 21 42; 
19 13 0 32 25; 
39 21 32 0 17; 
23 42 25 17 0]</code></pre>

<p>where we&#8217;ve assumed that the distance of a node to itself is 0 and the matrix is symmetric because the distance from A to B is the same as from B to A. </p>

<p>Next, let&#8217;s define a function that finds the total distance given a array of node numbers: </p>
<pre><code class="(null)">function totalDistance(nodes::Array{Int,1},distArray::Array{Int,2})
    sum=0;
    for i=1:length(nodes)-1
        sum+=distArray[nodes[i],nodes[i+1]];
    end
    sum + distArray[nodes[1],nodes[end]]
end</code></pre>

<p>As a test if we pass the totalDistance the array [1 2 3 4 5], we should get the result 111. </p>
<pre><code class="(null)">totalDistance([1:5],distances5)</code></pre>

<h4 id="permutations">Permutations</h4>

<p>This is a bit of a side conversation about permutations. In short to permute objects means to exchange their positions. Although permutations has a bigger scope and you can see <a href="https://en.wikipedia.org/wiki/Permutation">the Wikipedia page</a> on Permutations for more information, we are going to concentrate here on permuting the entries in a vector. Here are the following permutations of (1,2,3): (1,2,3),(1,3,2),(2,1,3),(2,3,1),(3,1,2),(3,2,1). </p>

<p>There are 6 total here and in general, there are n! permutations of a vector of length n. Julia has some nice built-in functions to create permutations. For example to create the 6 permutations listed above:</p>
<pre><code class="(null)">for i=1:6
    println(nthperm([1:3],i))
end</code></pre>

<p>we use the <code>nthperm</code> command which needs a vector and an integer. </p>

<h3 id="exploringallcasesofthetsp">Exploring all cases of the TSP</h3>

<p>In the case above, there are 5!=120 permutations. An exhaustive search of the TSP is simply passing every permutation of the vector [1 2 3 4 5] to the totalDistance function. Then you search for the smallest total distance. In the case above, we can find all distances via:</p>
<pre><code class="(null)">d=map(k-&gt;totalDistance(nthperm([1:5],k),distances5),[1:120])</code></pre>

<p>where the vector d now has the total distance for each permultation. The smallest one is given by:</p>
<pre><code class="(null)">findmin(d)</code></pre>

<p>which returns (93,7) meaning that the value 93 is the smallest distance and it occurs in the 7th place. To determine the path, apply the nthperm function again:</p>
<pre><code class="(null)">nthperm([1:5],7)</code></pre>

<p>which results the path [1 3 2 4 5] or A-&gt;C-&gt;B-&gt;D-&gt;E . </p>

<p>Note: there are other shortest paths, but this is just because you start in different places. For example D-&gt;B-&gt;E-&gt;E-&gt;A is also one. </p>

<h3 id="wedontneedtosearcheverything">We don&#8217;t need to search everything</h3>

<p>As we showed above, any solution will have each node in it. We can then always take the first node (A or 1) to be in the first location. This way we can just seach the first 4! permutations (this will always have A first). </p>

<p>If we repeat our seach using:</p>
<pre><code class="(null)">d=map(k-&gt;totalDistance(nthperm([1:5],k),distances5),[1:24])</code></pre>

<p>and then find the smallest value:</p>
<pre><code class="(null)">findmin(d)</code></pre>

<p>we get the same result. </p>

<h3 id="alargerexample">A larger example</h3>

<p>Let&#8217;s try a larger example. This is for 10 cities, but can be extended easily. First, let&#8217;s just generate a matrix with some nice numbers that have the same properties as the distances from above. </p>
<pre><code class="(null)">distances10=rand(5:20,10,10)</code></pre>

<p>will generate a 10 by 10 array of integers in the range 5:20. To make this symmetric we can add the transpose of the array (the flip over the main diagonal).</p>
<pre><code class="(null)">distances10=distances10+transpose(distances10)</code></pre>

<p>and then zero out the main diagonal. </p>
<pre><code class="(null)">for i=1:10
  distances10[i,i]=0
end</code></pre>

<p>and if you examine the distances10 array, you can see it has the properties we want. </p>

<p>Now, let&#8217;s compute the totalDistance for all paths:</p>
<pre><code class="(null)">d=map(k-&gt;totalDistance(nthperm([1:10],k),distances10),[1:factorial(9)])</code></pre>

<p>and if you look for the smallest</p>
<pre><code class="(null)">findmin(d)</code></pre>

<p>My results are <code>(174,3149)</code>, which means that the smallest distance is 174 and occurs for the 3149th permutation. You can find the permutation by typing</p>
<pre><code class="(null)">nthperm([1:10],3149)</code></pre>

<p>which results in <code>[1 2 3 8 6 5 4 10 7 9]</code> which would be the path A-&gt;B-&gt;C-&gt;H-&gt;F-&gt;E-&gt;D-&gt;J-&gt;G-&gt;I . </p>

<p>Note: since the distances are generated randomly, you will get a different path and minimum distance. </p>

<h3 id="thisisntrealisticforlargen.">This isn&#8217;t realistic for large n.</h3>

<p>The examples we&#8217;ve done so far are for relatively small n. If you try the method above for values much larger than 10, you&#8217;ll notice it takes a long time to solve. Also each increase to adding another node (or city) will increase the time by a increasing factor. Note this is an example of a problem that is solved in factorial time (or exponential time)</p>

<h3 id="simultatedannealing">Simultated Annealing</h3>

<p>A different way to think about this is to start with a path and then tweak it. Let&#8217;s try looking at the N=5 case. </p>

<p>If we start with the case <code>path=[1:5]</code> then the total distance is </p>
<pre><code class="(null)">distance=totalDistance(path,distances5)</code></pre>

<p>(or 120)</p>

<p>Next we will swap two elements at random. Here&#8217;s a helpful function to do the swap:</p>
<pre><code class="(null)">function swapEls!(A,i,j)
    tmp=A[i];A[i]=A[j];A[j]=tmp;
end</code></pre>

<p>and by typing </p>
<pre><code class="(null)">swapEls(path,rand(1:5),rand(1:5))</code></pre>

<p>and then there will be a new path. We&#8217;ll check what the value of the distance is. If it is smaller than distance (currently 120), then we&#8217;ll store the path and the distance. </p>

<p>This is then repeated a large number of times (but generally smaller than checking all permutations.)</p>

<p>(Here&#8217;s a function that will do everything)</p>
<pre><code class="(null)">function SATSP(N::Int,distances::Array{Int,2})
    path=[1:N]
    minPath=path
    minDist = totalDistance(path,distances)
    for i=1:10000
        local m
        swapEls!(path,rand(1:N),rand(1:N))
        m = totalDistance(path,distances)
        if m&lt;minDist
            minDist=m
            minPath=path
        end
    end
    return minDist,minPath
end</code></pre>

<h3 id="simulatedannealingforfindingminsofsmoothfunctions">Simulated Annealing for finding mins of smooth functions</h3>
<pre><code class="(null)">a=0
b=10
xmin=newton(df,d2f,0.5*(a+b))
fmin=f(xmin)
found=false
iters=0
while !found
    xNext=newton(df,d2f,xmin-0.5*rand()*(b-a))
    fNext=f(xNext)
    println(xNext,&quot; &quot;,fNext,&quot; &quot;,xmin,&quot; &quot;,fmin)
    if a&lt;xNext&lt;b &amp;&amp; fNext&lt;fmin
        xmin=xNext
        fmin=fNext
        iters=0
    else
        iters+=1
        if(iters&gt;500)
            found=true
        end
    end
end</code></pre>
<div style="display:none"><br/>
<!--This seemingly unnecessary div markup is the only thing keeping this script working after Markdown conversion. Trust me.--><br/>
 <script type="text/x-mathjax-config">  
  MathJax.Hub.Config({  
    tex2jax: {  
  inlineMath: [ ['$','$'], ["\\(","\\)"] ],  
  processEscapes: true  
}
  });  
</script><br/>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><br/>
</div>
<!-- ##END MARKED WRAPPER## -->
    </div>
</body>
</html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Chapter 9: Integral Calculus</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Chapter 9: Integral Calculus</h1>
</header>
<p><a href="ch-08.html">Previous Chapter</a> | <a href="index.html">Return to all notes</a> | <a href="ch-10.html">Next chapter</a></p>
<p>Naturally, Matlab and most CAS find antiderviatives. There are a few ways to do this. If we want the antiderivative of a function like <span class="math inline">\(x^{2}\)</span>, then we can type:</p>
<pre><code>syms x
int(x^2,x)</code></pre>
<p>which returns <span class="math inline">\(\dfrac{x^{3}}{3}\)</span> And note that there is no integration constant.</p>
<p>Matlab has many standard integration techniques (subsitution, trig substitution, by parts, among others). For example, evaluating: <span class="math display">\[\int {\frac {x\cos \left( \sqrt {x^{2}+1} \right) }{\sqrt {x^{2}+1}}}\, dx\]</span> results in <span class="math inline">\(\sin(\sqrt{x^{2}+1})\)</span> (where subsitution has been used).</p>
<p>Another example is the antiderivative of <span class="math inline">\(x^{7}{\rm e}^{2x}\)</span> which results in <span class="math display">\[\frac{{\mathrm{e}}^{2\,x} \,{\left(128\,x^7 -448\,x^6 +1344\,x^5 -3360\,x^4 +6720\,x^3 -10080\,x^2 +10080\,x-5040\right)}}{256}\]</span> in which the integration by parts formula has been applied 7 times.</p>
<p>Other times, you might get strange results. If we find the antiderivative of <span class="math inline">\({\rm e}^{-x^{2}}\)</span>, Maple returns <span class="math display">\[\frac{\sqrt{\pi }\,\mathrm{erf}\left(x\right)}{2} \]</span></p>
<p>What is this erf? Take a look in the Help Browser.</p>
<p>Quite amazingly, very few functions have a nice antiderivative, where nice means that you can write the result as a algebraic combination of functions that we know from Precalc and Calculus. Instead, functions, like <code>erf</code> (otherwise known as the error function), are defined as solutions to a differential equation or as an antiderivative. Here’s a list of a few</p>
<ul>
<li><span class="math inline">\(\displaystyle\int \frac{\sin x}{x} \, dx\)</span></li>
<li><span class="math inline">\(\displaystyle\int \cos(x^{2})\, dx\)</span></li>
<li><span class="math inline">\(\displaystyle\int \frac{1}{\sqrt{1-\sin^{2} \theta }} \, d\theta\)</span></li>
</ul>
<h2 id="definite-integrals">Definite Integrals</h2>
<p>You can find definite integrals also with the <code>int</code> command. To enter <span class="math inline">\(\displaystyle \int_0^{1} x^{2} \, dx\)</span>, type</p>
<pre><code>int(x^2,x,[0,1])</code></pre>
<p>and it will return <span class="math inline">\(\frac{1}{3}\)</span>.</p>
<h3 id="exercise">Exercise</h3>
<p>Try the following:</p>
<ul>
<li><span class="math inline">\(\displaystyle \int_0^{\pi/2} \sin x \, dx\)</span></li>
<li><span class="math inline">\(\displaystyle \int_{-1}^{2} {\rm e}^{2x} \, dx\)</span></li>
<li><span class="math inline">\(\displaystyle \int_0^{1} \tan^{-1} x \, dx\)</span>.</li>
</ul>
<h3 id="definite-integrals-with-infinite-bounds">Definite Integrals with infinite bounds</h3>
<p>You can also do definite integrals with infinite bounds. For example <span class="math display">\[\int_0^{\infty} {\rm e}^{-x} \,dx\]</span> is entered as</p>
<pre><code>int(exp(-x),[0 inf])</code></pre>
<p>and returns 1.</p>
<p>Let’s recall what this means. If you have any integral with an infinite limit, and if <span class="math inline">\(F(x)\)</span> is an antiderivative of <span class="math inline">\(f(x)\)</span>, then <span class="math display">\[\int_a^{\infty} f(x) \, dx = \lim_{b \rightarrow \infty} F(b)-F(a)\]</span></p>
<p>And we can let Matlab help us understand this. For example using the example of <span class="math inline">\(\int_0^{\infty} {\rm e}^{-x} \, dx\)</span> above, the antiderivative of <span class="math inline">\({\rm e}^{-x}\)</span> is <span class="math inline">\(-{\rm e}^{-x}\)</span> and let’s define this to be <span class="math inline">\(F\)</span> using</p>
<pre><code>F(x) = int(exp(-x),x)</code></pre>
<p>Then we take the limit of <span class="math inline">\(F(b)-F(0)\)</span></p>
<pre><code>syms b
limit(F(b)-F(0),b,inf)</code></pre>
<p>returns 1.</p>
<h3 id="exercise-1">Exercise</h3>
<p>Find the following:</p>
<ul>
<li><span class="math inline">\(\displaystyle \int_1^{\infty} \frac{1}{x} \, dx\)</span></li>
<li><span class="math inline">\(\displaystyle \int_{-\infty}^{\infty} {\rm e}^{-x^{2}} \, dx\)</span></li>
</ul>
<h2 id="reimann-sums">Reimann Sums</h2>
<p>When we first saw a definite integral in Calculus, we defined it in terms of a Reimann sum. For example if we are looking for the area under the curve <span class="math inline">\(f(x)=x^{2}+1\)</span>, and we use rectangles based on the left endpoint, the following plot is helpful:</p>
<figure>
<img src="images/ch09/plot01.png" alt="Plot of x^{2}+1 and its Riemann sum using left endpoints" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}+1\)</span> and its Riemann sum using left endpoints</figcaption>
</figure>
<p>We then define the definite integral in terms of a limit: <span class="math display">\[
\int_a^{b} f(x) \,dx={\lim_{\Delta x \rightarrow 0}}\sum_{i=1}^{N} f(x_i^{\star}) \Delta x
\]</span></p>
<p>where <span class="math inline">\(\Delta x=(b-a)/N\)</span> and <span class="math inline">\(x_i^{\star}\)</span> is a number in the ith subinterval. Generally, <span class="math inline">\(x_i^{\star}\)</span> can be the left endpoint, the right end point, the mid point or a value at the minimum or maximum of the function in the subinterval.</p>
<p>Matlab doesn’t have this built-in, but here’s a function that will plot the function and the rectangles:</p>
<pre><code>function riemannSum(f,a,b,options)
    arguments
        f function_handle
        a (1,1) {mustBeNumeric}
        b (1,1) {mustBeNumeric}
        options.n (1,1) {mustBePositive,mustBeInteger} = 10
        options.style {mustBeMember(options.style,[&quot;left&quot;,&quot;midpoint&quot;,&quot;right&quot;])} = &quot;midpoint&quot;
        options.output {mustBeMember(options.output,[&quot;value&quot;,&quot;plot&quot;])} = &quot;plot&quot;
    end
  dx = (b-a)/options.n;
  if strcmp(options.style,&#39;left&#39;)
    xval = linspace(a,b-dx,options.n);
    x = xval;
  elseif strcmp(options.style, &#39;right&#39;)
    xval = linspace(a+dx,b,options.n);
    x = xval-dx;
  else
    xval = linspace(a+0.5*dx,b-0.5*dx,options.n);
    x = xval-0.5*dx;
  end
  y =arrayfun(f,xval);
  
  if strcmp(options.output,&#39;plot&#39;)
    g = bar(x,y,&#39;histc&#39;); % Moves labels to the left
    g.FaceColor = &#39;none&#39;;    % Changes the fill of bars
    g.EdgeColor = &#39;b&#39;;       % Changes edge color of bars
    hold on
    fplot(f,[a b]);
    hold off
  else
    dx*sum(y)
  end
end</code></pre>
<p>and remember to put this at the bottom of your live script to use it.</p>
<p>The above plot was made with</p>
<pre><code>riemannSum(@(x) 1+x^2,0,2,&#39;style&#39;,&#39;left&#39;,&#39;n&#39;,10)</code></pre>
<p>and if we want to use the right endpoints then:</p>
<pre><code>riemannSum(@(x) 1+x^2,0,2,&#39;style&#39;,&#39;right&#39;,&#39;n&#39;,10)</code></pre>
<p>which returns: <img src="images/ch09/plot02.png" alt="Plot of x^{2}+1 and a Riemann Sum" /></p>
<p>and midpoints can be found using:</p>
<pre><code>riemannSum(@(x) 1+x^2,0,2,&#39;style&#39;,&#39;midpoint&#39;,&#39;n&#39;,10)</code></pre>
<p>will return the following plot: <img src="images/ch09/plot03.png" alt="Plot of x^{2}+1 and a Riemann Sum" /></p>
<p>You can also get the value of the Riemann sum from the same function by use the ‘output’,‘value’ options, like</p>
<pre><code>riemannSum(@(x) 1+x^2,0,2,&#39;style&#39;,&#39;left&#39;,&#39;n&#39;,10,&#39;output&#39;,&#39;value&#39;)</code></pre>
<p>which returns 4.2800, and this is the area of the rectangles for the left Riemann sum.</p>
<h3 id="exercises">Exercises:</h3>
<ol type="1">
<li><p>Find the Riemann sum for 15 subintervals for <span class="math inline">\(f(x)=\sin x\)</span> on <span class="math inline">\([0,1]\)</span> using the left, right and midpoints.</p></li>
<li><p>Find the exact answer for the area (using the definite integral.)</p></li>
</ol>
<h2 id="numerical-integration">Numerical Integration</h2>
<p>As we have mentioned above often it is impossible to find the value of an integral or that a new function is defined to be the antiderivative (like the error function). However, it’s fairly clear that for many functions, that the area under the curve is well defined and we should be able to find an answer or at least an approximate answer.</p>
<p>For example, what if we want to find the area under <span class="math inline">\(e^{-x^{2}}\)</span> on the interval <span class="math inline">\([0,1]\)</span>. From a plot: <img src="images/ch09/plot04.png" alt="Plot of e^{-x^{2}} on the interval [0,1]" /> it appears to have an answer is probably between 0.5 and 1.</p>
<p>One way to find an approximate answer would be to use the Riemann sum. For example,</p>
<pre><code>riemannSum(@(x) exp(x^2),0,1,&#39;style&#39;,&#39;midpoint&#39;,&#39;n&#39;,10,&#39;output&#39;,&#39;value&#39;)
</code></pre>
<p>and this returns 0.7471</p>
<p>Recall that in the limit as the number of subintervals goes to <span class="math inline">\(\infty\)</span> that the approximation equals the actual area, so this method can lead to better approximation, however there are better techniques.</p>
<h3 id="trapezoid-method">Trapezoid Method</h3>
<p>Instead of approximating the area with rectangles, we can use trapezoids to do this. A plot of the approximate integral of <span class="math inline">\(\sin x\)</span> on the interval <span class="math inline">\([0,\pi]\)</span> is given by <img src="images/ch09/plot05.png" alt="Plot of the trapezoid approximation of \sin x on [0,\pi]" /></p>
<p>The basic part of the trapezoid method is to use the area of a trapezoid on an interval with width <span class="math inline">\(h\)</span>. The area of one of the trapezoids is</p>
<p><span class="math display">\[A_i = \frac{1}{2}(f(x_i)+f(x_{i+1})) h\]</span></p>
<p>and then a full approximation will be the sum of these: <span class="math display">\[A={\sum_{i=1}^{n-1}} \frac{h}{2}(f(x_i)+f(x\_{i+1}))\]</span></p>
<p><span class="math display">\[A=\frac{h}{2}\left(f(x_0)+f(x_1)+f(x_1)+f(x_2)+ \cdots + f(x_{n-1})+f(x_n)\right)\]</span></p>
<p><span class="math display">\[A=\frac{h}{2}\left( f(x_0) + 2\sum_{i=1}^{n-1} f(x_i) + f(x_n)\right)\]</span></p>
<p>As an example above, if we use 4 subintervals, the approximation is <span class="math display">\[A=\frac{h}{2}\left(f(0)+2f(\pi/4)+2f(\pi/2)+2f(3\pi/4)+f(\pi)\right)\]</span> where there are 2’s in front of most of the <span class="math inline">\(f\)</span>’s is that the interior ones are counted twice.<br />
<span class="math display">\[A=\frac{\pi/4}{2}\left(0+2\frac{\sqrt{2}}{2} + 2(1) + 2\frac{\sqrt{2}}{2} + 0 \right)\]</span> <span class="math display">\[A= \frac{\pi}{8}\left(2\sqrt{2}+2\right) \approx 1.896\]</span></p>
<p>We can do this in Matlab using the <code>trapezoid</code> function that we defined here:</p>
<pre><code>function output = trapezoid(f,a,b,options)
    arguments
        f function_handle
        a (1,1) {mustBeNumeric}
        b (1,1) {mustBeNumeric}
        options.n (1,1) {mustBePositive,mustBeInteger} = 10
        options.output {mustBeMember(options.output,[&quot;value&quot;,&quot;plot&quot;])} = &quot;plot&quot;
    end
  dx = (b-a)/options.n;
  xvals = linspace(a,b,options.n+1);
  fvals = arrayfun(@(x) f(x),xvals);
  if strcmp(options.output,&#39;plot&#39;)
    fplot(f,[a b])
    hold on
    plot(xvals,fvals,&#39;red&#39;)
    for i=1:length(xvals)
      plot([xvals(i) xvals(i)],[0 fvals(i)],&#39;red&#39;)
    end
    hold off
  else
    output = 0.5*dx*(sum(fvals(1:options.n))+sum(fvals(2:options.n+1)));  
  end
end</code></pre>
<p>The way to get the plot above is:</p>
<pre><code>trapezoid(@(x) f(x),0,pi,&#39;n&#39;,4)</code></pre>
<p>and it is helpful to get the approximate value by:</p>
<pre><code>val = trapezoid(@(x) f(x),0,pi,&#39;n&#39;,4,&#39;output&#39;,&#39;value&#39;)</code></pre>
<p>which returns:</p>
<p><span class="math display">\[\frac{\pi \,{\left(2\,\sqrt{2}+2\right)}}{8}\]</span> the same as we did by hand above. To get a decimal value of this:</p>
<pre><code>double(val)</code></pre>
<p>returns 1.8961.</p>
<h3 id="exercise-2">Exercise</h3>
<p>Find <span class="math inline">\(\int_0^{1} {\rm e}^{-x^{2}}\,dx\)</span> using the trapezoid method for <span class="math inline">\(4, 10\)</span> and <span class="math inline">\(20\)</span> points.</p>
<h2 id="simpsons-rule">Simpson’s Rule</h2>
<p>The trapezoid rule uses straight lines to approximate the function and then integrates the line (or finds the area of the trapezoid). To find a better approximation if we use a quadratic function (parabola) to esimate the function.</p>
<p>For example, if we use the function <span class="math inline">\(f(x)=x {\rm e}^{-x}\)</span>, on the interval <span class="math inline">\(0 \leq x \leq 2\)</span>, we find a quadratic of the form: <span class="math display">\[Q(x)=a + b x + c x^{2}\]</span> that passes through the points <span class="math inline">\((0,f(0))\)</span>, <span class="math inline">\((1,f(1))\)</span>, <span class="math inline">\((2,f(2))\)</span>. A plot of the function and the points is: <img src="images/ch08/plot05.png" alt="Plot of f(x) and the point x=0,1,2" /></p>
<p>We then find the quadratic (meaning we find the constants <span class="math inline">\(a, b\)</span> and <span class="math inline">\(c\)</span> of <span class="math inline">\(Q(x)\)</span>) or</p>
<pre><code>solve([Q(0) = f(0), Q(1) = f(1), Q(2) = f(2)])</code></pre>
<p>returns <span class="math display">\[\{a = 0, b = 2 {\rm e}^{-1} - {\rm e}^{-2}, c = -{\rm e}^{-1}+{\rm e}^{-2}\}\]</span></p>
<p>and then a plot of the quadratic that passes through these points is: <img src="images/ch08/plot06.png" alt="Plot of f, Q and the points through which they pass" /></p>
<p>To estimate the integral <span class="math inline">\(\int_0^{2} f(x)\,dx\)</span>, we instead find <span class="math display">\[A=\int_0^{2} Q(x)\,dx = \int_0^{2} (a + b x + cx^{2}) \,dx\]</span> <span class="math display">\[A= \left. ax+\frac{bx^{2}}{2} + \frac{cx^{3}}{3} \right|\_0^{2} =
a(2)+b\frac{4}{2} + c\frac{8}{3}\]</span> and substituting the values of <span class="math inline">\(a, b, c\)</span> in, <span class="math display">\[A = \frac{4}{3} {\rm e}^{-1} + \frac{2}{3} {\rm e}^{-2}\approx 0.58073\]</span></p>
<p>and in this case, the actual value of the integral <span class="math inline">\(A^{\star}\)</span> is <span class="math display">\[A^{\star}=\int_0^{2} f(x) \,dx = 1-3{\rm e}^{-2} \approx 0.59399\]</span></p>
<p>###Exercise</p>
<p>Find <span class="math inline">\(\int_0^{1} {\rm e}^{-x^{2}} \,dx\)</span> using Simpson’s rule for <span class="math inline">\(n=4, 10\)</span> and 20 subintervals.</p>
<h3 id="simpsons-rule-in-maple">Simpson’s Rule in Maple</h3>
<p>The <code>ApproximateInt</code> command in Maple is similar to that using the trapezoid rule, by just using the <code>method=simpson</code> option. For example,</p>
<pre><code>ApproximateInt(f(x), x = 0 .. 2, output = plot, method = simpson, partition = 1, boxoptions = [filled = [color = pink, transparency = .5]])</code></pre>
<p>does what we saw above and yields the plot: <img src="images/ch08/plot07.png" alt="Simpson’s rule plot of f(x)=x{\rm e}^{-x}" /></p>
<p>and to find the value of the approximation, use</p>
<pre><code>ApproximateInt(f(x), x = 0 .. 2, partition = 1, output = sum, method = simpson)</code></pre>
<p>then <code>value((#))</code> of the line above and you will get: <span class="math display">\[\frac{4}{3}{\rm e}^{-1} + \frac{2}{3}{\rm e}^{-2}\]</span></p>
<h3 id="general-form-of-simpsons-rule">General Form of Simpson’s Rule</h3>
<p>The following is a derivation of Simpson’s rule for <span class="math inline">\(n\)</span> subintervals. First, we are going to going to consider just 1 subinterval. Let the function we are trying to integrate be <span class="math inline">\(f(x)\)</span> on the interval <span class="math inline">\([a,b]\)</span>. We are going to call <span class="math inline">\(x_0\)</span> and <span class="math inline">\(x_2\)</span> the endpoints of this interval and <span class="math inline">\(x_1\)</span>, the midpoint or <span class="math display">\[x_1=\frac{a+b}{2}\]</span></p>
<p>Recall above that we sought a quadratic that passes through these points. If we define:</p>
<pre><code>Q:=x-&gt;c0+c1*x+c2*x^2</code></pre>
<p>and then find the coefficients that have the function <span class="math inline">\(Q\)</span> satisfy the function <span class="math inline">\(f\)</span> at the points <span class="math inline">\(a\)</span>, <span class="math inline">\((a+b)/2\)</span> and <span class="math inline">\(b\)</span>, then we can let Maple do the hard work and</p>
<pre><code>c:=solve([f(a)=Q(a),f((a+b)/2)=Q((a+b)/2),f(b)=Q(b)],[c0,c1,c2])</code></pre>
<p>where you need to say what Maple should solve for, since there are unknowns <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> in this as well. Maple will return quite a mess, but hang in there. Next, we want to integrate <span class="math inline">\(Q\)</span> from <span class="math inline">\([a,b]\)</span></p>
<pre><code>int(Q(x),x=a..b)</code></pre>
<p>then substitution the values from the coeffs line above or</p>
<pre><code>subs(c[1],(#))</code></pre>
<p>where (#) is the line number of the integral and if you simplify the result will give: <span class="math display">\[-\frac{1}{6}\,af \left( b \right) +\frac{1}{6}\,bf \left( b \right) -\frac{2a}{3}\,f \left( \frac{a}{2}+\frac{b}{2}\right) +\frac{2b}{3}f \left(\frac{a}{2}+\frac{b}{2}\right) -\frac{a}{6}f \left( a
 \right) +\frac{b}{6}f \left( a \right)\]</span></p>
<p>and this is still a little bit of a mess because we have the relationship that <span class="math inline">\(b=a+h\)</span> and if we substitute this in</p>
<pre><code>simplify(subs(b=a+h,(#)))</code></pre>
<p>for the line number above, then the result can be written: <span class="math display">\[I =\frac{h}{6}\left(f(a)+4f\left(a+\frac{h}{2}\right)+f(a+h)\right)\]</span></p>
<h3 id="simpsons-rule-for-n-subintervals">Simpson’s Rule for <span class="math inline">\(n\)</span> subintervals:</h3>
<p>If we break up the interval <span class="math inline">\([a,b]\)</span> into <span class="math inline">\(n\)</span> subintervals, we can write: <span class="math display">\[x_i = a+\frac{ih}{2}\qquad\text{where}\qquad h=\frac{b-a}{n}\]</span> then <span class="math display">\[I =\frac{h}{6}\left(f(x\_0) + 4 f(x\_1) + f(x\_2) + f(x\_2) + 4 f(x\_3) + f(x\_4)+ \cdots + f(x\_{2n-2})+4f(x\_{2n-1})+f(x\_{2n})\right)\]</span> or <span class="math display">\[I = \frac{h}{6} \left(f(x\_0)+ f(x\_{2n}) + 4 \sum_{k=1}^{n} f(x\_{2k-1}) + 2\sum\_{k=1}^{n+1} x\_{2k} \right)\]</span></p>
<p>###Example</p>
<p>Use the formula above to approximate <span class="math inline">\(\int_0^{2} x{\rm e}^{-x}\)</span> using <span class="math inline">\(n=4\)</span> subintervals.</p>
<p>In this case, <span class="math display">\[h=\frac{2-0}{4}=0.5\qquad\text{and}\qquad x_{i} = 0 + 0.25i\]</span></p>
<p>Then <span class="math display">\[I_4=\frac{0.5}{6}\left(f(0)+f(2)+ 4(f(0.25)+f(0.75)+f(1.25)+f(1.75))+2(f(0.5)+f(1)+f(1.5))\right) \]</span></p>
<p><span class="math display">\[I_4=\frac{1}{12}\left({ {\rm e}^{-1/4}}+{ {\rm e}^{-1/2}}+3\,{ {\rm e}^{-3/4}}+2\,{ {\rm e}^{-1}
}+5\,{ {\rm e}^{-5/4}}+3\,{ {\rm e}^{-3/2}}+7\,{ {\rm e}^{-7/4}}+2\,{
{\rm e}^{-2}}
\right)\approx 0.59393\]</span></p>
<h3 id="simpsons-38-rule-and-booles-rule">Simpson’s 3/8-rule and Boole’s Rule</h3>
<p>If a cubic function is used to approximate the function, then the approximate method becomes Simpson’’s 3/8 rule and if a quartic is used is called Boole’s Rule.</p>
<p>The following command</p>
<pre><code>ApproximateInt(x*exp(-x), x = 0 .. 2, partition = 1, method = simpson[3/8], output = plot, boxoptions = [filled = [color = pink, transparency = .5]])</code></pre>
<p>produces the following plot: <img src="images/ch08/plot08.png" alt="Approximating \int_0^{2} x{\rm e}^{-x} \, dx using Simpson’s 3/8 rule" /></p>
<p>and as you can see above, the cubic approximation is quite good, even when only using 1 subinterval.</p>
<p>The following command:</p>
<pre><code>ApproximateInt(x*exp(-x), x = 0 .. 2, partition = 1, method = boole, output = plot, boxoptions = [filled = [color = pink, transparency = .5]])</code></pre>
<p>produces the following plot: <img src="images/ch08/plot09.png" alt="Approximating \int_0^{2} x{\rm e}^{-x} \, dx using Simpson’s 3/8 rule" /></p>
<p>which shows that the quartic approximation is very good for this function.</p>
<h3 id="example">Example</h3>
<p>Reproduce <span class="math inline">\(\int_0^{2} x {\rm e}^{-x} \,dx\)</span> using 4 subintervals using Simpson’s 3/8-rule and Boole’s Rule</p>
<pre><code>evalf(ApproximateInt(x*e^(-x),x=0..2,partition=4,method=simpson[3/8]))</code></pre>
<p>returns <code>0.5939668110</code> and we can check the error by typing:</p>
<pre><code>evalf(abs(int(x*exp(-x), x = 0 .. 2)-(#)))</code></pre>
<p>where (#) is the line number of the approximation and the result is <code>0.0000273394</code></p>
<p>and checking the approximation using Boole’s rule:</p>
<pre><code>evalf(ApproximateInt(x*e^(-x),x=0..2,partition=4,method=boole))</code></pre>
<p>returns <code>0.5939941135</code> and we can check the error by typing:</p>
<pre><code>evalf(abs(int(x*exp(-x), x = 0 .. 2)-(#)))</code></pre>
<p>where (#) is the line number of the approximation and the result is <code>0.0000273394</code> returns <span class="math display">\[3.69\cdot 10^{-8}\]</span></p>
<p>So the approximation is nearly 8 digits.</p>
<h2 id="numerical-integration-1">Numerical Integration</h2>
<p>We saw above using specific techniques to find numerical solutions to definite integrals. It is important to know how these techniques work and to understand what is going on when you need to do an integral numerically.</p>
<p>However, there are times when you just want the answer to a definite integral, you want it accurate to some level and you aren’t that concerned with how Maple comes up with the answer.</p>
<p>Let’s return to the example <span class="math inline">\(\int_0^{1} {\rm e}^{-x^{2}} \, dx\)</span>, which is related to probabilities under the normal curve. If we just want to find the integral of this and do it using some numerical technique, let’s type:</p>
<pre><code>int(exp(-x^2), x = 0 .. 1, numeric = true)</code></pre>
<p>and the result is 0.7468241328. If we want more digits of accuracy, we can type:</p>
<pre><code>int(exp(-x^2), x = 0 .. 1, numeric = true, digits = 20)</code></pre>
<p>which will return the answer to 20 digits. (Pretty cool!!)</p>
<h3 id="exercise-3">Exercise</h3>
<p>Evaluate <span class="math inline">\(\int_0^{2} \sqrt{4-x^{2}}\,dx\)</span> to 20 digits. Is that what you expected? Why?</p>
<p><a href="ch-08.html">Previous Chapter</a> | <a href="index.html">Return to all notes</a> | <a href="ch-10.html">Next chapter</a></p>
</body>
</html>

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Chapter 7: More Plots</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Chapter 7: More Plots</h1>
</header>
<p><a href="ch-06.html">Previous Chapter</a> | <a href="index.html">Return to all notes</a> | <a href="ch-08.html">Next chapter</a></p>
<p>We have already seen that Matlab has some great plotting capabilities. In this chapter, we will see a number of other plots that Matlab (and most CAS programs) can produce. Note: we covered many of these in <a href="ch-02.html">Chapter 2</a>, but are repeated here so everything is in one chapter.</p>
<h3 id="plotting-functions">Plotting Functions</h3>
<p>In order to plot the expression <span class="math inline">\(x^{2}\)</span>, try typing <code>fplot(x^2)</code>. You should see a plot similar to</p>
<figure>
<img src="images/ch02/plot01.png" alt="Plot of x^{2} using the default plotting range" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span> using the default plotting range</figcaption>
</figure>
<h3 id="changing-the-plotting-window-of-a-plot">Changing the Plotting Window of a plot</h3>
<p>Typically, the easiest way to change the plotting window of the plot is to use an option in the plot command. For example, if we want a plot on the interval <span class="math inline">\([-2,2]\)</span>, then typing <code>fplot(x^2,[-2 2])</code> will produce the plot:</p>
<figure>
<img src="images/ch02/plot02.png" alt="Plot of x^{2} on [-2,2]" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span> on <span class="math inline">\([-2,2]\)</span></figcaption>
</figure>
<p>If you want to make sure that the axes include other y values, you can adjust the limits after the fact. After you have the plot, try</p>
<pre><code>fplot(x^2,[-2 2])
ylim([-2 2])</code></pre>
<p>which will generate:</p>
<figure>
<img src="images/ch02/plot03.png" alt="Plot of x^{2} for -2 \leq x \leq 2 and -2 \leq y \leq 2" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span> for <span class="math inline">\(-2 \leq x \leq 2\)</span> and <span class="math inline">\(-2 \leq y \leq 2\)</span></figcaption>
</figure>
<p>If you’d like a title on your plot, you can add the title option. For example, try</p>
<pre><code>fplot(x^2,[-2 2])
title(&quot;A plot of x^2&quot;)</code></pre>
<p>and you will see</p>
<figure>
<img src="images/ch02/plot04.png" alt="Plot of x^{2} with a title" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span> with a title</figcaption>
</figure>
<p>Notice that matlab does some fancy formatting in that it formats <code>x^2</code> as a power. You can put latex commands in the title (we will see what latex is later in the course.)</p>
<h3 id="using-coordinate-axes">Using Coordinate Axes</h3>
<p>The standard way that Matlab plots functions is to use a box style with the tick marks on the bottom and left of the box. If instead, you desire the standard coordinate axes, you can apply:</p>
<pre><code>set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)</code></pre>
<p>after any plot. For example, the plot above with the plotting window adjusted as:</p>
<pre><code>fplot(x^2,[-2 2])
ylim([-2 2])
title(&quot;A plot of x^2&quot;)
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)</code></pre>
<p>will produce:</p>
<figure>
<img src="images/ch07/plot01.png" alt="Plot of x^2 using coordinate axes" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^2\)</span> using coordinate axes</figcaption>
</figure>
<h3 id="changing-the-tick-marks">Changing the tick marks</h3>
<p>A plot of <span class="math inline">\(\cos x\)</span> on <span class="math inline">\([-2\pi,2\pi]\)</span>, can be generated with:</p>
<pre><code>fplot(cos(x),[-2*pi 2*pi])</code></pre>
<p>and looks like: <img src="images/ch07/plot02.png" alt="Plot of x^2 using coordinate axes" /></p>
<p>and I’m sure you noticed (since you are quite astute) that the tick marks are in integers and it would be nice to see the function plot in fractions of <span class="math inline">\(\pi\)</span> instead. We can change this with the <code>xticks</code> and <code>xticklabels</code> functions. Here is a cosine plot with some nicer ticks:</p>
<pre><code>fplot(cos(x),[-2*pi 2*pi])
S =  sym(-2*pi:pi/2:2*pi);
xticks(double(S))
xticklabels(arrayfun(@texlabel,S,&#39;UniformOutput&#39;,false))</code></pre>
<p>and the result is:</p>
<figure>
<img src="images/ch02/plot05.png" alt="Plot of \cos(x) on [-2\pi,2\pi]" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(\cos(x)\)</span> on <span class="math inline">\([-2\pi,2\pi]\)</span></figcaption>
</figure>
<p>Before just plowing on, let’s go through those last statements in detail. The line:</p>
<pre><code>S =  sym(-2*pi:pi/2:2*pi);</code></pre>
<p>creates an array of symbolic values from <span class="math inline">\(-2\pi\)</span> to <span class="math inline">\(2\pi\)</span> by steps of <span class="math inline">\(\pi/2\)</span>. (Take the semicolon off the end of the line and rerun to see). The line</p>
<pre><code>xticks(double(S))</code></pre>
<p>sets the xticks to the numerical values (that’s what the <code>double</code> function does) to the numbers in <code>S</code>. Then</p>
<pre><code>xticklabels(arrayfun(@texlabel,S,&#39;UniformOutput&#39;,false))</code></pre>
<p>set’s the tick labels on the x-axis to the values in <code>S</code>. We’ll see the <code>arrayfun</code> later and the <code>@texlabel</code> function is a way to ensure that the latex command is used to make things look better. Again, we’ll talk about latex later in the course.</p>
<p>Make a mental note that this allows us to change the x-ticks to multiples of <span class="math inline">\(\pi\)</span> is a much nicer way. You’ll need this later.</p>
<h3 id="plotting-multiple-functions">Plotting multiple functions</h3>
<p>Often, we would like to include more that one function on a single set of axes. Here is how to plot both <span class="math inline">\(x^2\)</span> and <span class="math inline">\(x^3\)</span>.</p>
<pre><code>fplot([x^2, x^3],[-3,3])</code></pre>
<p>The result is:</p>
<figure>
<img src="images/ch02/plot06.png" alt="Plots of multiple functions on the same axes" /><figcaption aria-hidden="true">Plots of multiple functions on the same axes</figcaption>
</figure>
<h3 id="adding-a-legend">Adding a Legend</h3>
<p>A legend is important for any plot containing more than one function. This allows you to distinguish between the curves. There is a legend option to the plot function. For example, to add a legend and a title to the plot of <span class="math inline">\(x^{2}\)</span> and <span class="math inline">\(x^{3}\)</span> type:</p>
<pre><code>fplot([x^2 x^3], [-3,3])
title(&quot;A plot of x^2 and x^3&quot;)
legend(&quot;x^2&quot;,&quot;x^3&quot;)</code></pre>
<p>and you will see: <img src="images/ch02/plot07.png" alt="A plot of two functions with a legend" /></p>
<h2 id="changing-the-aspect-ratio-of-a-plot">Changing the Aspect Ratio of a Plot</h2>
<p>Recall that the function <span class="math inline">\(f(x)=\sqrt{4-x^2}\)</span> is the top half of a circle. If we plot this with</p>
<pre><code>fplot(sqrt(4-x^2),[-2 2])</code></pre>
<p>we’ll get the following plot: <img src="images/ch02/plot08.png" alt="A plot the top half of a circle" /></p>
<p>and this just doesn’t look like a circle. This is because the aspect ratio isn’t 1–this means that 1 unit in the x-direction and 1 unit in the y-direction are not equal.</p>
<p>We can do that in Matlab with the following:</p>
<pre><code>fplot(sqrt(4-x^2),[-2 2])
daspect([1 1 1])</code></pre>
<p>and the result is: <img src="images/ch02/plot09.png" alt="A plot the top half of a circle" /></p>
<p>Note: there are three numbers here because we will see 3D plots need can have different aspects as well. Matlab does this in general by ensuring that it know the relative sizes of all three axes.</p>
<h2 id="piecewise-functions">Piecewise Functions</h2>
<p>Another common plot is that of a piecewise function, consider <span class="math display">\[f(x) = \begin{cases} x &amp; x&lt;0 \\ 3-x^{2} &amp; x \geq 0 \end{cases}\]</span></p>
<p>Recall that a piecewise function is a function <span class="math inline">\(f\)</span> takes on the values of <span class="math inline">\(x\)</span> when <span class="math inline">\(x&lt;0\)</span> and when <span class="math inline">\(x \geq 0\)</span>, then it has the functional form <span class="math inline">\(3-x^2\)</span>. We wil plot this by creating a plot with two different curves on it.</p>
<p>The way to enter this in is the following:</p>
<pre><code>f = piecewise(x&lt;0,x,x&gt;=0,3-x^2)
fplot(f, [-3 3])</code></pre>
<p>and this results in the following plot: <img src="images/ch02/plot11.png" alt="Plot of a piecewise function" /></p>
<p>The vertical line connecting (0,0) with (0,3) is not part of the plot. Matlab simply just connects a bunch of points. Sometimes it seems that it can figure out that it’s not part of the plot. Unfortunately, if it doesn’t automatically remove the line, you need to do something different, like the following:</p>
<pre><code>fplot(f,[0,3])
hold on
fplot(f,[-3,-0.0001])
hold off</code></pre>
<p>which first plots the function on the interval <span class="math inline">\([0,3]\)</span>, then holds the plot which means that we can add additional graphs on the plot. Then we plot the function on <span class="math inline">\([-3,-0.0001]\)</span>, which is just an approximation of 0–if you put in 0, you get the same results as above. Lastly, <code>hold off</code> switches the plot back to normal (meaning don’t add additional graphs).</p>
<p>The result is</p>
<figure>
<img src="images/ch02/plot12.png" alt="Improved plot of a piecewise function" /><figcaption aria-hidden="true">Improved plot of a piecewise function</figcaption>
</figure>
<p>which is better but it looks like two different curves becaues the two pieces are different colors. We can set them both to be the same color with:</p>
<pre><code>fplot(f,[0,3],&#39;blue&#39;)
hold on
fplot(f,[-3,-0.0001],&#39;blue&#39;)
hold off</code></pre>
<figure>
<img src="images/ch02/plot13.png" alt="Improved plot of a piecewise function" /><figcaption aria-hidden="true">Improved plot of a piecewise function</figcaption>
</figure>
<h4 id="exercise">Exercise</h4>
<p>Plot the piecewise function:</p>
<p><span class="math display">\[
    f(x) = \begin{cases}
    1-(x-\pi/2)^2 &amp; x &gt; \frac{\pi}{2} \\
    1 &amp; -\frac{\pi}{2} \leq x \leq \frac{\pi}{2} \\
    \sin x &amp; x &lt; -\frac{\pi}{2} \\
    \end{cases}
\]</span></p>
<h2 id="plotting-functions-with-discontinuities">Plotting Functions with discontinuities</h2>
<p>Although Matlab doesn’t often pick up on jump discontinuities from piecewise functions, it seems to do well with infinite discontinuities. Consider:</p>
<pre><code>fplot(1/(x-1),[-3,3])</code></pre>
<p>which has the result:</p>
<figure>
<img src="images/ch02/plot14.png" alt="plot of 1/(x-1)" /><figcaption aria-hidden="true">plot of 1/(x-1)</figcaption>
</figure>
<p>The vertical dashed line is a vertical asymptote in this case.</p>
<h4 id="exercise-1">Exercise</h4>
<p>Plot <span class="math inline">\(f(x) = \tan(x)\)</span> on <span class="math inline">\([-3\pi,3\pi]\)</span> and use multiples of <span class="math inline">\(\pi/2\)</span> for the horizontal labels. Hint: see above to do this. Does Matlab correctly pick up the vertical asymptotes in this case?</p>
<h2 id="scatter-plots">Scatter Plots</h2>
<p>A scatter plot is a set of points plotted in the <span class="math inline">\(xy\)</span>-plane. Consider the points <span class="math inline">\((0,1), (1,3), (3,4), (6,5), (8,8), (10,9)\)</span>. We will see how to plot this.</p>
<p>For this, we create a vectors of the x points and y points:</p>
<pre><code>xvals=[0 1 3 6 8 10]
yvals=[1 3 4 5 8 9]</code></pre>
<p>and the call the function <code>scatter</code>:</p>
<pre><code>scatter(xvals,yvals)</code></pre>
<p>resulting in</p>
<figure>
<img src="images/ch02/plot15.png" alt="Example of a scatter plot" /><figcaption aria-hidden="true">Example of a scatter plot</figcaption>
</figure>
<p>Notice that the points by default are open circles, which are hard to see. The next exercise goes through how to change the type and size.</p>
<h3 id="changing-the-size-shape-and-other-attributes-of-the-points">Changing the size, shape and other attributes of the points</h3>
<p>Personally, I don’t think open circles are very good visually even though this is the default in Matlab. This section shows how to change attributes of the points.</p>
<h4 id="point-size">point size</h4>
<p>Adding a number in the scatter changes the point size. For example:</p>
<pre><code>scatter(xvals,yvals,50)</code></pre>
<p>roughly doubles the size of the points. Try increasing or decreasing the point size.</p>
<h4 id="filled-in-points">Filled in Points</h4>
<p>Add the option <code>'filled'</code> inside the <code>scatter</code> command to fill in the circles.</p>
<pre><code>scatter(xvals,yvals,&#39;filled&#39;)</code></pre>
<p>and you can using both the size and <code>'filled'</code> together.</p>
<h4 id="change-the-marker">Change the marker</h4>
<p>Here’s a list of different types of markers for each of the points: * <code>'o'</code> circle * <code>'d'</code> diamond * <code>'*'</code> asterisk (star) * <code>'.'</code> point * <code>'x'</code> cross</p>
<p>and there are others. See the help page for <code>scatter</code> for all of the options</p>
<h4 id="marker-color">Marker color</h4>
<p>You can change the marker color both the edge and face by adding the following to the <code>scatter</code> plot: * <code>'r'</code> or <code>'red'</code> — red * <code>'g'</code> or <code>'green'</code> — green * <code>'b'</code> or <code>'blue'</code> — blue * <code>'c'</code> or <code>'cyan'</code> — cyan * <code>'m'</code> or <code>'magenta'</code> — magenta * <code>'y'</code> or <code>'yellow'</code> — yellow * <code>'k'</code> or <code>'black'</code> — black * <code>'w'</code> or <code>'white'</code> — white</p>
<h4 id="example">Example</h4>
<p>The following changes the size, shaped, fills the marker and change the color:</p>
<pre><code>scatter(xvals,yvals,150,&#39;d&#39;,&#39;filled&#39;,&#39;MarkerFaceColor&#39;,&#39;magenta&#39;)</code></pre>
<h3 id="combining-scatter-and-function-plots">Combining Scatter and Function Plots</h3>
<p>We can combine a scatter and function plots using the <code>hold</code> command. Let’s say we have the points: (0,10),(2,9),(3,7),(5,6),(7,4),(8,2) and we wish to plot a best fit line as well. First, let’s define the points</p>
<pre><code>xvals = [0,2,3,5,7,8];
yvals = [10,9,7,6,4,2];</code></pre>
<p>The best-fit line can be found to be <span class="math inline">\(y=10.8665-0.9680x\)</span> and we will show how to do this later.</p>
<pre><code>syms x
scatter(xvals,yvals,100,&#39;blue&#39;,&#39;filled&#39;);
hold on
fplot(10.8665-0.9680*x,[-0.5,9])
hold off</code></pre>
<p>This will produce a plot that looks like:</p>
<figure>
<img src="images/ch07/plot20.png" alt="Plot with functions and dots" /><figcaption aria-hidden="true">Plot with functions and dots</figcaption>
</figure>
<h3 id="loading-a-file-for-a-scatter-plot">Loading a file for a scatter plot</h3>
<p>First, download the file <a href="iris.csv">iris.csv</a> and save the file in the directory where you are working.</p>
<pre><code>iris = readmatrix(&#39;iris.csv&#39;)</code></pre>
<p>and you should see that it loaded a file that has 150 rows and 5 columns. And then we can plot individual columns:</p>
<pre><code>scatter(iris(:,1),iris(:,2),50,&#39;filled&#39;,&#39;r&#39;)
axis equal</code></pre>
<p>plots the first and second columns. The result is <img src="images/ch07/plot21.png" alt="Scatter plot from a file" /></p>
<h2 id="implicit-plots">Implicit Plots</h2>
<p>If a you have a function of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> and would like to visualize the set of points that satisfy the curve, then <code>fimplicit</code> is what you want to use. For example, the circle with center of the origin and radius 5 is</p>
<pre><code>syms x y
fimplicit(x^2+y^2==25)
daspect([1 1 1])</code></pre>
<p>will give the following plot:</p>
<figure>
<img src="images/ch07/plot03.png" alt="Plot of a circle written implicitly" /><figcaption aria-hidden="true">Plot of a circle written implicitly</figcaption>
</figure>
<p>where the aspect ratio has been set to 1 to make the circle like a circle. Another example where this is needed is:</p>
<pre><code>fimplicit(x^2/9+y^2/16==1)</code></pre>
<p>generates <img src="images/ch07/plot04.png" alt="Plot of x^2/9+y^2/16==1" /> and is an ellipse, but just doesn’t look right without changing the plotting window and the aspect ratio.</p>
<p>The commands:</p>
<pre><code>fimplicit(x^2/9+y^2/16==1)
xlim([-5 5])
ylim([-5 5])
daspect([1 1 1])
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)</code></pre>
<p>results in <img src="images/ch07/plot05.png" alt="Plot of x^2/9+y^2/16==1" /></p>
<h3 id="multiple-implicit-curves">Multiple Implicit Curves</h3>
<p>If we want to plot the circles <span class="math inline">\(x^2+y^2=r^2\)</span> for <span class="math inline">\(r=1,2,3,4\)</span>, we could do 4 implicit curves. This points out that an alterative is to write then differently. We could write the circle of radius 1 as <span class="math display">\[x^2+y^2-1=0\]</span> instead and recall that this is the set of all points that make this equation 0. If we combine that with the circle of radius 2 by</p>
<pre><code>two_circles = (x^2+y^2-1)*(x^2+y^2-4)</code></pre>
<p>then this is still all the points that make this equation zero, but it could be the set of points on the circle of radius 1 or radius 2. If we define:</p>
<pre><code>circles = (x^2+y^2-1)*(x^2+y^2-4)*(x^2+y^2-9)*(x^2+y^2-16)</code></pre>
<p>and plot the results with</p>
<pre><code>fimplicit(circles)
daspect([1 1 1])</code></pre>
<p>we get</p>
<figure>
<img src="images/ch07/plot06.png" alt="Plot of the 4 concentric circles" /><figcaption aria-hidden="true">Plot of the 4 concentric circles</figcaption>
</figure>
<h3 id="plotting-an-implicit-curve-and-a-tangent-line.">Plotting an implicit curve and a tangent line.</h3>
<p>In <a href="ch-05.html">Chapter 5</a>, we found the tangent line to the elipitic curve <span class="math display">\[y^2=x^3-4x+1\]</span> at the point <span class="math inline">\((-1,2)\)</span> with the following step. First the plot is</p>
<pre><code>syms x y
elliptic_curve = y^2==x^3-4*x+1
fimplicit(elliptic_curve)
daspect([1 1 1])</code></pre>
<p>which is <img src="images/ch07/plot07.png" alt="Plot of the elliptic curve y^2=x^3-4x+1" /></p>
<p>and we can find the tangent line with</p>
<pre><code>F(x,y) = lhs(elliptic_curve)-rhs(elliptic_curve)
dydx = -diff(F(x,y),x)/diff(F(x,y),y)
m = subs(dydx,[x y], [-1 2])
tanLine = m*(x+1)+2</code></pre>
<p>which shows the tangent line is <span class="math display">\[ y = \frac{7}{4}-\frac{x}{4}\]</span> and although we could plot it implicitly with the curve by setting both equal to zero, instead we’ll use the hold function</p>
<pre><code>fimplicit(elliptic_curve)
hold on
fplot(tanLine)
hold off
title(&quot;Elliptic curve and the its tangent line&quot;)
legend(&quot;y^2=x^3-4x+1&quot;,&quot;tangent&quot;,&#39;Location&#39;,&#39;northwest&#39;)
daspect([1 1 1])</code></pre>
<p>which shows that</p>
<figure>
<img src="images/ch07/plot08.png" alt="Plot of a circle and its tangent line" /><figcaption aria-hidden="true">Plot of a circle and its tangent line</figcaption>
</figure>
<p>###Exercise</p>
<ol type="1">
<li>Plot the cardiod given by <span class="math inline">\(x^{2}+y^{2} = (2x^{2}+2y^{2}-x)^{2}\)</span></li>
<li>Find the tangent line to the curve at <span class="math inline">\(P(0,-1/2)\)</span>.</li>
</ol>
<h2 id="parametric-plots">Parametric Plots</h2>
<p>A parametric graph or parametric curve is one in which the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> coordinates depend on another variable, often <span class="math inline">\(t\)</span>. In general, we write <span class="math display">\[x=f(t) \qquad y=g(t)\]</span></p>
<p>A nice example is <span class="math display">\[x=t^{2} \qquad y=t^{3}-t\]</span></p>
<p>For a given set of values of <span class="math inline">\(t\)</span>, the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values can be found by plugging into the functions <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span>.</p>
<p>First define <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span> in Matlab:</p>
<pre><code>syms t
x(t) = t^2
y(t) = t^3-t</code></pre>
<p>and then we can make a table with:</p>
<pre><code>xvals = arrayfun(@(t) x(t),-2:0.5:2)
yvals = arrayfun(@(t) y(t),-2:0.5:2)
[-2:0.5:2; xvals; yvals]&#39;</code></pre>
<p><span class="math display">\[\begin{array}{c|c|c}
t &amp; x &amp; y &amp;  \\ \hline
-2 &amp; 4 &amp; -6
-1.5 &amp; 2.25 &amp; -1.875 \\
-1 &amp; 1 &amp; 0 \\
-1/2 &amp; 1/4 &amp; -3/8 \\
0 &amp; 0 &amp; 0 \\
1/2 &amp; 1/4 &amp; 3/8 \\
1 &amp; 1 &amp; 0 \\
1.5 &amp; 2.25 &amp; 1.875 \\
2 &amp; 4 &amp; 6 
\end{array}\]</span></p>
<p>We can plot the points in Matlab with:</p>
<pre><code>plot(xvals,yvals)
daspect([1 1 1])</code></pre>
<p>and this leads to</p>
<figure>
<img src="images/ch07/plot09.png" alt="Points from parametric plot" /><figcaption aria-hidden="true">Points from parametric plot</figcaption>
</figure>
<p>Of course Matlab also has the direct way of plotting a parametric curve with</p>
<pre><code>fplot(x(t),y(t),[-2 2])</code></pre>
<p>which leads to <img src="images/ch07/plot10.png" alt="parametric plot" /></p>
<h3 id="another-example">Another example</h3>
<p>The parametric curve given by <span class="math display">\[x=\cos t \qquad y=\sin t\]</span> for <span class="math inline">\(0\leq t \leq 2\pi\)</span> is another way to write a circle with center at the origin and radius of 1.</p>
<p>This is because if we plug these functions into the equation <span class="math inline">\(x^{2}+y^{2}=1\)</span>, then <span class="math display">\[
(\cos t)^{2}+(\sin t)^{2}=1
\]</span> which is true for all <span class="math inline">\(t\)</span> because <span class="math inline">\(\cos^{2} t + \sin^{2} t =1\)</span>.</p>
<p>We can plot this with</p>
<pre><code>fplot(cos(t),sin(t),[0 2*pi])
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)
daspect([1 1 1])</code></pre>
<p>which results in <img src="images/ch07/plot11.png" alt="Circle plotted parametrically" /></p>
<p>We can shift any curve horizontally and vertically in the following way, which we’ll show using an example. If we shift the circle above right 3 and up 2, we’ll get the circle with center <span class="math inline">\((3,2)\)</span>. This curve can be written: <span class="math display">\[x=3+\cos t \qquad y=2+\sin t\]</span> and plotting with a window that includes the origin is:</p>
<figure>
<img src="images/ch07/plot12.png" alt="Shifted circle" /><figcaption aria-hidden="true">Shifted circle</figcaption>
</figure>
<p>And we can make this an ellipse by multiplying the <span class="math inline">\(\cos t\)</span> and <span class="math inline">\(\sin t\)</span> terms by constants. For example,</p>
<p><span class="math display">\[x=3+1.5\cos t \qquad y=2+0.8\sin t,\]</span> if we enter</p>
<pre><code>fplot(1.5*cos(t)+3,0.8*sin(t)+2,[0 2*pi])
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)
xlim([-1 5])
ylim([-1 5])
daspect([1 1 1])</code></pre>
<p>where the scaling is constrained so that the ellipse looks like an ellipse.</p>
<figure>
<img src="images/ch07/plot13.png" alt="Plot of a an ellipse written parametrically" /><figcaption aria-hidden="true">Plot of a an ellipse written parametrically</figcaption>
</figure>
<h3 id="tangent-line-to-a-parametric-curve">Tangent line to a parametric curve</h3>
<p>Here we reproduce the tangent line to the circle of radius 5 at the point <span class="math inline">\((3,4)\)</span>.</p>
<p>The parametric curve given by <span class="math display">\[x=5\cos t \qquad y=5\sin t\]</span> for <span class="math inline">\(0\leq t \leq 2\pi\)</span> is another way to write a circle with center at the origin and radius of 5.</p>
<p>To plot this in Matlab, we use the <code>fplot</code> command with a different syntax.</p>
<pre><code>syms t
fplot(5*cos(t),5*sin(t),[0,2*pi])
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)
daspect([1 1 1])</code></pre>
<p>will produce the following circle.</p>
<figure>
<img src="images/ch07/plot14.png" alt="Plot of a circle written parametrically" /><figcaption aria-hidden="true">Plot of a circle written parametrically</figcaption>
</figure>
<p>which is the same plot as the implicit one above.</p>
<p>To make some things easier, let’s define</p>
<pre><code>x(t)=5*cos(t)
y(t)=5*sin(t)</code></pre>
<p>We can also find the tangent line to a parametric curve in the following way. The derivative <span class="math inline">\(\frac{dy}{dx}\)</span> to a curve can be written: <span class="math display">\[
\frac{dy}{dx} = \frac{\frac{dy}{dt}}{\frac{dx}{dt}}
\]</span></p>
<p>To find the derivative to the circle above at the point <span class="math inline">\((3,4)\)</span>, we need to find the <span class="math inline">\(t\)</span> value at the point. We can do this by solving for <span class="math inline">\(t\)</span> by setting <span class="math inline">\(x=3\)</span> and <span class="math inline">\(y=4\)</span>.</p>
<pre><code>t1 = solve(x(t)==3)
t2 = solve(y(t)==4)</code></pre>
<p>The first returns <span class="math display">\[\left(\begin{array}{c}
-\mathrm{acos}\left(\frac{3}{5}\right)\\
\mathrm{acos}\left(\frac{3}{5}\right)
\end{array}\right)\]</span> and the second returns <span class="math display">\[\left(\begin{array}{c}
\mathrm{asin}\left(\frac{4}{5}\right)\\
\pi -\mathrm{asin}\left(\frac{4}{5}\right)
\end{array}\right)\]</span></p>
<p>For each, there are two values (remember the way that solving trig functions work from Chapter ??? ). Let’s see which one is correct by plugging back into the functions <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<pre><code>x(t1)
y(t1)</code></pre>
<p>and the first returns: <span class="math display">\[\left(\begin{array}{c}
3\\
3
\end{array}\right)\]</span> with the second <span class="math display">\[\left(\begin{array}{c}
-4\\
4
\end{array}\right)\]</span> showing that the second value of <code>t1</code> is the correct value of t.</p>
<p>Alternatively if we look at</p>
<pre><code>x(t2)
y(t2)</code></pre>
<p>the first returns <span class="math display">\[\left(\begin{array}{c}
3\\
-3
\end{array}\right)\]</span> and the second returns <span class="math display">\[\left(\begin{array}{c}
4\\
4
\end{array}\right)\]</span> This shows that the first value of <code>t2</code> is correct.</p>
<p>To find the derivative at a point, we use the following:</p>
<pre><code>dydx(t) = diff(y(t),t)/diff(x(t),t)</code></pre>
<p>which returns: <span class="math display">\[-\frac{\mathrm{cos}\left(t\right)}{\mathrm{sin}\left(t\right)}\]</span> And to find the slope, we need to plug in the value of <span class="math inline">\(t\)</span> found above. It was the second element of <code>t1</code> so</p>
<pre><code>dydx(t1(2))</code></pre>
<p>which return <span class="math inline">\(-3/4\)</span>. Alternatively, we can use the first element of <code>t2</code> or</p>
<pre><code>dydx(t2(1))</code></pre>
<p>which also returns <span class="math inline">\(-3/4\)</span>.</p>
<p>Note that if just type out the value of <span class="math inline">\(t\)</span>, we get a bit of a mess:</p>
<pre><code>dydx(acos(3/5))</code></pre>
<p>the result is <span class="math display">\[-\frac{\mathrm{cos}\left(\frac{522020799781813}{562949953421312}\right)}{\mathrm{sin}\left(\frac{522020799781813}{562949953421312}\right)}
\]</span> which isn’t as nice as <span class="math inline">\(-3/4\)</span>. The reason this happened is because <code>acos(3/5)</code> gave a result of 0.9273… which is rounded off a bit and then Matlab using an exact version of that number as a fraction.</p>
<p>The tangent line then is the curve</p>
<pre><code>sym x
tanLine=-3/4(x-3)+4</code></pre>
<pre><code>fplot(5*cos(t),5*sin(t),[0,2*pi])
hold on
fplot(tanLine)
hold off
daspect([1 1 1])
xlim([-8 8])
legend(&quot;x^2+y^2==1&quot;,&quot;tangent line&quot;)</code></pre>
<p>with give the following plot:</p>
<figure>
<img src="images/ch07/plot15.png" alt="plot of a circle with its tangent line" /><figcaption aria-hidden="true">plot of a circle with its tangent line</figcaption>
</figure>
<h4 id="plotting-a-line-segment-parametrically">Plotting a Line Segment parametrically</h4>
<p>Often it is nice to plot a line segment. Consider the line segment between points <span class="math display">\[P(x_1,y_1) \qquad\text{and}\qquad Q(x_2,y_1)\]</span> one way to do this is to find the line between these and the plot the line only on the values of x that are value.</p>
<p>There are a couple of problems with this: 1. You’d have to find the slope of the line. Even though this isn’t too hard, it’s a calculation that would need to happen. 1. If the two points have the same <span class="math inline">\(x\)</span>-coordinate, then the slope isn’t defined and you couldn’t do it.</p>
<p>Instead, we’re going to define the line segment using a paramtric curve as: <span class="math display">\[ x(t)  =  x_2 t + (1-t) x_1 \qquad y(t) = y_2 t + (1-t) y_1\]</span></p>
<p>In short, this works because when <span class="math inline">\(t=0\)</span>, then <span class="math inline">\(x(0) = x_2 \cdot (0) + 1 \cdot x_1 = x_1\)</span> and <span class="math inline">\(y(0) = y_2 \cdot (0) + 1 \cdot y_1 = y_1\)</span>. Similarly, when <span class="math inline">\(t=1\)</span>, <span class="math inline">\(x(1)=x_2\)</span> and <span class="math inline">\(y(1)=y_2\)</span>, so if we plot this parametrically for <span class="math inline">\(0 \leq t \leq 1\)</span>, then we get all the points on line between <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span>.</p>
<p>An example plotted would be the point between <span class="math inline">\((-2,1)\)</span> and <span class="math inline">\((3,4)\)</span> would be the parametric curve: <span class="math display">\[ x(t) = 3 t + (-2)(1-t) \qquad y(t) = 4 t + 1(1-t) \]</span></p>
<h2 id="polar-plots">Polar Plots</h2>
<p>It is often that one will use polar coordinates to create a plot. Here are a few examples where this is helpful. If a function is written in polar coordinates, then it is written in the form <span class="math inline">\(r=f(\theta)\)</span>.</p>
<p>This is a specific form of a parametric curve with the form: <span class="math display">\[x=f(\theta) \cos \theta \qquad y=f(\theta)\sin \theta\]</span></p>
<p>For example, the cardioid that you plotted above can be written: <span class="math display">\[r=1+\cos(\theta)\]</span> and we can plot it using the <code>ezpolar</code> command</p>
<pre><code>syms th
ezplot(1+cos(th))</code></pre>
<p>The plot will look like: <img src="images/ch07/plot16.png" alt="A cardioid plotting in polar coords" /></p>
<h3 id="a-tangent-line-to-a-polar-plot.">A tangent line to a polar plot.</h3>
<p>The curve <span class="math inline">\(r=1+2\sin \theta\)</span> passes through the origin. We will find the tangent line to the curve at the point.</p>
<p>First, a plot of the curve is found by</p>
<pre><code>ezpolar(1+2*sin(th))</code></pre>
<p>resulting in</p>
<figure>
<img src="images/ch07/plot17.png" alt="Plot of the curve r=1+2\sin \theta" /><figcaption aria-hidden="true">Plot of the curve <span class="math inline">\(r=1+2\sin \theta\)</span></figcaption>
</figure>
<p>We now seek the tangent line to the curve at the point <span class="math inline">\(P(1,0)\)</span>. It’s helpful to define the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> coordinates parametrically using <span class="math inline">\(x=r \cos \theta\)</span> and <span class="math inline">\(y=r \sin \theta\)</span> for <span class="math inline">\(r=1+2\sin \theta\)</span>:</p>
<pre><code>x(th) = (1+2*sin(th))*cos(th)
y(th) = (1+2*sin(th))*sin(th)</code></pre>
<p>And then to find the value of <span class="math inline">\(\theta\)</span> at the point <span class="math inline">\(P(1,0)\)</span>, we set <span class="math inline">\(x=1\)</span> and <span class="math inline">\(y=0\)</span>.</p>
<pre><code>th1 = solve(x(th)==1,&#39;Real&#39;,true)</code></pre>
<p>which returns <span class="math display">\[\left(\begin{array}{c}
2\,\mathrm{atan}\left(\frac{1}{9\,\left(\frac{\sqrt{27}\,\sqrt{29}}{27}+\frac{28}{27}\right)^{1/3} }+\left(\frac{\sqrt{27}\,\sqrt{29}}{27}+\frac{28}{27}\right)^{1/3} -\frac{2}{3}\right)\\
0
\end{array}\right)\]</span> which looks like a bit of a mess. Note we have used the option <code>'Real',true</code> in the <code>solve</code> command to ensure we only get real (not complex) numbers for a solution.</p>
<p>As we do before, we’d like to know if either of these are the right values for <code>th</code>, so we plug into <code>x(t)</code> and <code>y(t)</code> with</p>
<pre><code>x(th1)
y(th1)</code></pre>
<p>and we get a bit of a mess, but the second value gives <span class="math inline">\(x=1\)</span> and <span class="math inline">\(y=0\)</span>, the point we want, so <code>th=0</code> is the right point.</p>
<p>The slope of the tangent line at the point <span class="math inline">\((1,0)\)</span>, where <span class="math inline">\(\theta=0\)</span> is</p>
<pre><code>dydx(th) = diff(y(th),th)/diff(x(th),th)
m = dydx(0)</code></pre>
<p>which is <span class="math inline">\(\frac{1}{2}\)</span>. Then using the point-slope formula for the tangent line, we get: <span class="math display">\[y=\frac{1}{2}(x-1)+0\]</span></p>
<p>To plot both, we’ll use the parametric form (an alternative way will be presented below):</p>
<pre><code>syms x
ezpolar(1+2*sin(th))
hold on
fplot(m*(x-1))
hold off</code></pre>
<p>to get the plot: <img src="images/ch07/plot18.png" alt="A plot of a polar curve and its tangent line" /></p>
<h3 id="exercise-2">Exercise</h3>
<p>Find the tangent line to the cardioid <span class="math inline">\(r=1+\cos(\theta)\)</span> at the point <span class="math inline">\((0,1)\)</span>. Plot both on the same axes.</p>
<h2 id="putting-multiple-plots-together">Putting multiple plots together</h2>
<p>There have a been a few examples earlier about putting multiple plots together and Matlab has a very robust way to do this. This section explains it.</p>
<p>In generally, command that produce plots, like <code>fplot</code>, <code>plot</code>,<code>ezpolar</code>,<code>scatter</code> other will simply just produce a new plot of what you requested.</p>
<p>Instead, if you want to superimpose plots, then the <code>hold</code> command is necessary. Let’s look at an example that we did earlier:</p>
<pre><code>fplot(5*cos(t),5*sin(t),[0,2*pi])
hold on
fplot(-3/4*(x-3)+4)
hold off
daspect([1 1 1])
xlim([-8 8])
legend(&quot;x^2+y^2==1&quot;,&quot;tangent line&quot;)</code></pre>
<ol type="1">
<li>The first line plots a function parametrically.<br />
</li>
<li><code>hold on</code> tells Matlab that any subsequent plots will go on the same axes (superimpose) on this plot.</li>
<li>plots the tangent line</li>
<li><code>hold off</code> says to go back to the orignal way of plotting in which subsequent plotting commands produces a new plot.</li>
</ol>
<h2 id="animated-plots">Animated Plots</h2>
<p>Animated plot are often helpful to visualize if you have a parameter in a plot and you want to view what’s happening to it. Consider the following: How does the parameter <span class="math inline">\(a\)</span> affect the graph of <span class="math inline">\(y=(x-t)^{2}\)</span>. Examine <span class="math inline">\(t\)</span> from <span class="math inline">\(-3\)</span> to <span class="math inline">\(3\)</span>.</p>
<pre><code>syms t x
fanimator(@fplot,(x-t)^2,[-6 6],&#39;AnimationRange&#39;,[-3 3])
xlim([-4 4])
ylim([-2 6])
axis equal
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)
playAnimation</code></pre>
<p>where primarily the <code>fanimator</code> function is the important thing here. The arguments of this are</p>
<ul>
<li>plotting function handle. Any of the plotting functions in Matlab are valid here. Just remember, you need a handle, that is, put a <code>@</code> in front.</li>
<li>The next two arguments are the plotting arguments. In this case, the function and the plotting range.<br />
</li>
<li>The last two argument are the options that set the values of <span class="math inline">\(t\)</span> (by default)</li>
</ul>
<p>Also, the command <code>playAnimation</code> simply just plays the animation.</p>
<p>The following animation is the result:</p>
<figure>
<img src="images/ch07/animation01.gif" alt="plot of (x-a)^{2}" /><figcaption aria-hidden="true">plot of <span class="math inline">\((x-a)^{2}\)</span></figcaption>
</figure>
<h3 id="a-parametric-example">A Parametric Example</h3>
<p>Perhaps we want to see what happens to the parametric curve <span class="math display">\[
x=5\cos(t)\qquad y=b\sin t\]</span> for some <span class="math inline">\(b\)</span> values.</p>
<p>Since this is a paramtric plot, we need to include both <span class="math inline">\(x(t)\)</span> and <span class="math inline">\(y(t)\)</span>. Also, we need to tell <code>fanimator</code> that we are using <code>b</code> as the parameter.</p>
<pre><code>syms t b
fanimator(@fplot,5*cos(t),b*sin(t),[0, 2*pi],&#39;AnimationRange&#39;,[1 8],&#39;AnimationParameter&#39;,sym(&#39;b&#39;))
hold on
fanimator(@(b) text(6,7,&quot;b=&quot;+num2str(b,2)+&quot; &quot;),&#39;AnimationRange&#39;,[1 8],&#39;AnimationParameter&#39;,sym(&#39;b&#39;));
hold off

xlim([-8 8])
ylim([-8 8])
axis equal
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)
playAnimation</code></pre>
<p>The result is</p>
<figure>
<img src="images/ch07/animation03.gif" alt="plot of the parametric curve x(t) = 5 \cos t, y(t)=b\sin(t)" /><figcaption aria-hidden="true">plot of the parametric curve <span class="math inline">\(x(t) = 5 \cos t\)</span>, <span class="math inline">\(y(t)=b\sin(t)\)</span></figcaption>
</figure>
<p>You can see that this is an ellipse in which the <span class="math inline">\(y\)</span>-range of the ellipse is the valid of <span class="math inline">\(b\)</span>.</p>
<h3 id="an-polar-plot-example">An polar plot example</h3>
<p>We can also make a animation based on a polar plot. Consider <span class="math display">\[r(\theta)=1-a\sin \theta\]</span> for <span class="math inline">\(-4 \leq a \leq 4\)</span>.</p>
<p>Unfortunatetly, it doesn’t appear that ezpolar and fanimator play nice together, so recall that a polar plot is just a parametric plot of a particular form, so we’ll plot that:</p>
<p>The following will produce an animation of this:</p>
<pre><code>syms th a x y
x(th) = (1-a*sin(th))*cos(th);
y(th) = (1-a*sin(th))*sin(th);
fanimator(@fplot,x(th),y(th),[0 2*pi],&#39;AnimationRange&#39;,[-4 4],&#39;AnimationParameter&#39;,sym(&#39;a&#39;))
hold on
fanimator(@(a) text(4,4,&quot;a=&quot;+num2str(a,2)+&quot; &quot;),&#39;AnimationRange&#39;,[-4 4],&#39;AnimationParameter&#39;,sym(&#39;a&#39;));
hold off

xlim([-5 5])
ylim([-5 5])
axis equal
set(gca, &#39;XAxisLocation&#39;, &#39;origin&#39;, &#39;YAxisLocation&#39;, &#39;origin&#39;)
playAnimation</code></pre>
<figure>
<img src="images/ch07/animation04.gif" alt="plot of the polar curve r=1-a\sin(\theta)" /><figcaption aria-hidden="true">plot of the polar curve <span class="math inline">\(r=1-a\sin(\theta)\)</span></figcaption>
</figure>
<h3 id="exercise-3">Exercise</h3>
<p>The set of points defined by <span class="math display">\[y^{2} (y^{2}-a^{2})=x^{2}(x^{2}-b^{2})\]</span> are called the Devil’s curve. Let <span class="math inline">\(b=1\)</span>, and let <span class="math inline">\(a\)</span> range from 0.1 to 2.1 in an animated plot.</p>
<h2 id="three-dimensional-plots">Three Dimensional Plots</h2>
<p>Maple also handles some plots in three dimensions. This is just a few examples. Take a look at the Help Browser for more information on these.</p>
<p>Notice after plotting each of these, you can use your mouse to spin the plot around getting a better perspective.</p>
<h3 id="three-d-function-plot-surface-plot">Three-D Function plot (Surface Plot)</h3>
<p>This is plot of the function <span class="math inline">\(z=x^{2}+y^{2}\)</span>.</p>
<pre><code>syms x y
fsurf(x^2+y^2)</code></pre>
<figure>
<img src="images/ch07/plot25.png" alt="3D plot of z=x^{2}+y^{2}" /><figcaption aria-hidden="true">3D plot of <span class="math inline">\(z=x^{2}+y^{2}\)</span></figcaption>
</figure>
<p>And if you click on the plot there is a cube with a rotating arrow button at the top. Click that and you can rotate the plot.</p>
<h3 id="three-d-parametric-plot">Three-D parametric plot</h3>
<p>This is a plot of a helix written parametrically: <span class="math display">\[x=\cos t \qquad y=\sin t \qquad z=t/10\]</span></p>
<pre><code>syms t
fplot3(cos(t),sin(t),t,[0,4*pi])</code></pre>
<p>which results in</p>
<figure>
<img src="images/ch07/plot26.png" alt="plot of the helix" /><figcaption aria-hidden="true">plot of the helix</figcaption>
</figure>
<h3 id="implicit-plot-in-3-variables">Implicit plot in 3 variables</h3>
<p>Here’s a plot of the sphere <span class="math display">\[x^{2}+y^{2}+z^{2}=1\]</span></p>
<pre><code>implicitplot3d(x^2+y^2+z^2 = 1, x = -1 .. 1, y = -1 .. 1, z = -1 .. 1)</code></pre>
<p>which produces the plot: <img src="images/ch07/plot27.png" alt="plot of a sphere" /></p>
<p>And the following plots both an ellipsoid and a plane that cuts through it:</p>
<pre><code>syms x y z
fimplicit3(x^2/4+y^2/9+z^2==1)
hold on
fimplicit3(x+2*y+3*z==1)
hold off
daspect([1 1 1])
view([-99.57 27.87])
plot28.png&quot;)</code></pre>
<p>where the <code>view([-99.57 27.87])</code> line was created when rotating and inserted. The resulting plot is: <img src="images/ch07/plot28.png" alt="plot of an ellipsoid and a Plane" /></p>
<h3 id="vector-field-plots">Vector Field plots</h3>
<p>A basic plot of the field <span class="math inline">\(\textbf{F} = y \hat{i}-x \hat{j}\)</span> is</p>
<pre><code>[X,Y] = meshgrid(-2:0.25:2);
DX = Y;
DY = -X;
quiver(X,Y,DX,DY)</code></pre>
<p>gives the plot:</p>
<figure>
<img src="images/ch07/plot29.png" alt="Plot of a vector field" /><figcaption aria-hidden="true">Plot of a vector field</figcaption>
</figure>
<p>and if you want a direction field (in that the length of the vectors are all the same)</p>
<pre><code>[X,Y] = meshgrid(-2:0.25:2);
DX = Y;
DY = -X;
L = sqrt(DX.^2+DY.^2);
quiver(X,Y,DX./L,DY./L)</code></pre>
<p>and the result is <img src="images/ch07/plot30.png" alt="Plot of a vector field" /></p>
<p>If we want a 3D plot of a vector field, say <span class="math display">\[\vec{F}(x,y,z) = x \hat{i}+y \hat{j} + z \hat{k}\]</span></p>
<pre><code>[X,Y,Z] = meshgrid(-2:0.5:2,-2:0.5:2,-2:0.5:2);
DX = X;
DY = Y;
DZ = Z;
quiver3(X,Y,Z,DX,DY,DZ)</code></pre>
<p>produces</p>
<figure>
<img src="images/ch07/plot31.png" alt="Plot of a 3D vector field" /><figcaption aria-hidden="true">Plot of a 3D vector field</figcaption>
</figure>
</body>
</html>

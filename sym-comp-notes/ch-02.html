<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Chapter 2: Plotting Basics</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Chapter 2: Plotting Basics</h1>
</header>
<p><a href="index.html">Return to all notes</a></p>
<h2 id="storing-numbers-and-expressions">Storing Numbers and Expressions</h2>
<p>Below we will be plotting <span class="math inline">\(x^{2}\)</span> with many different options. In the case of <span class="math inline">\(x^{2}\)</span> it is short enough to type out each time, but if we have a complicated function, we probably don’t want to. In such a case, we will store the expression as a name. To do this, we’ll use <code>=</code>. For example</p>
<pre><code>f=x^2</code></pre>
<p>will give the expression <span class="math inline">\(x^{2}\)</span> a name (or a variable in the computer science sense) called <code>f</code>. Note: if you get an error, like <code>x not defined</code>, don’t forget to tell matlab that <span class="math inline">\(x\)</span> is a symbolic variable with <code>syms x</code>.</p>
<p>By “doing” something to <code>f</code>, we are in fact doing that to <span class="math inline">\(x^{2}\)</span>. A better example is if we type</p>
<pre><code>g=(x+2)^2</code></pre>
<p>and the we can expand it by</p>
<pre><code>expand(g)</code></pre>
<p>which returns <span class="math inline">\(x^{2}+4x+4\)</span>.</p>
<h3 id="anything-can-be-stored">Anything can be stored</h3>
<p>We can store numbers, equations, expressions (and other things) using the same syntax. For example</p>
<pre><code>eqn:=x^2=9</code></pre>
<p>and then <code>solve(eqn)</code> returns 3,-3, the two solutions to the equation <span class="math inline">\(x^{2}=9\)</span>.</p>
<h3 id="rules-for-names">Rules for names</h3>
<p>The rules for giving something a name is that it contain a digit, a letter (upper- or lower-case) or an _ (underscore). It must also start with a letter.</p>
<h2 id="plotting">Plotting</h2>
<p>Most CAS systems will produce very nice plots and Matlab is among these. The standard plot will be that of a function, but we will see that plotting multiple functions and points is also possible. Matlab is very flexible in creating plots.</p>
<h3 id="plotting-functions">Plotting Functions</h3>
<p>In order to plot the expression <span class="math inline">\(x^{2}\)</span>, try typing <code>fplot(x^2)</code>. You should see a plot similar to</p>
<figure>
<img src="images/ch02/plot01.png" alt="Plot of x^{2}" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span></figcaption>
</figure>
<h3 id="changing-the-plotting-window-of-a-plot">Changing the Plotting Window of a plot</h3>
<p>Typically, the easiest way to change the plotting window of the plot is to use an option in the plot command. For example, if we want a plot on the interval <span class="math inline">\([-2,2]\)</span>, then typing <code>fplot(x^2,[-2 2])</code> will produce the plot:</p>
<figure>
<img src="images/ch02/plot02.png" alt="Plot of x^{2} on [-2,2]" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span> on <span class="math inline">\([-2,2]\)</span></figcaption>
</figure>
<p>If you want to make sure that the axes include other y values, you can adjust the limits after the fact. After you have the plot, try <code>ylim([-2 2])</code> which will generate:</p>
<figure>
<img src="images/ch02/plot03.png" alt="Plot of x^{2} for -2 \leq x \leq 2 and -2 \leq y \leq 2" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span> for <span class="math inline">\(-2 \leq x \leq 2\)</span> and <span class="math inline">\(-2 \leq y \leq 2\)</span></figcaption>
</figure>
<p>If you’d like a title on your plot, you can add the title option. For example, try</p>
<pre><code>fplot(x^2,[-2 2])
title(&quot;A plot of x^2&quot;)</code></pre>
<p>and you will see</p>
<figure>
<img src="images/ch02/plot04.png" alt="Plot of x^{2} with a title" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(x^{2}\)</span> with a title</figcaption>
</figure>
<p>Notice that matlab does some fancy formatting in that it formats <code>x^2</code> as a power. You can put latex commands in the title (we will see what latex is later in the course.)</p>
<h3 id="exercise">Exercise</h3>
<p>Plot <span class="math inline">\(f(x) = \sin x\)</span> on the domain <span class="math inline">\([−6.25, 6.25]\)</span>. Give the plot a title that includes the function.</p>
<h3 id="changing-the-tick-marks">Changing the tick marks</h3>
<p>I’m sure you notice (since you are quite astute) that the tick marks are in decimals and it would be nice to see the function plot in fractions of <span class="math inline">\(\pi\)</span> instead. We can change this with the <code>xticks</code> and <code>xticklabels</code> functions. Here is a cosine plot with some nicer ticks:</p>
<pre><code>fplot(cos(x),[-2*pi 2*pi])
S =  sym(-2*pi:pi/2:2*pi);
xticks(double(S))
xticklabels(arrayfun(@texlabel,S,&#39;UniformOutput&#39;,false))</code></pre>
<p>and the result is:</p>
<figure>
<img src="images/ch02/plot05.png" alt="Plot of \cos(x) on [-2\pi,2\pi]" /><figcaption aria-hidden="true">Plot of <span class="math inline">\(\cos(x)\)</span> on <span class="math inline">\([-2\pi,2\pi]\)</span></figcaption>
</figure>
<h3 id="plotting-multiple-functions">Plotting multiple functions</h3>
<p>Often, we would like to include more that one function on a single set of axes. Matlab does this by doing multiple plots but holding the plot. Here is how to plot both <span class="math inline">\(x^2\)</span> and <span class="math inline">\(x^3\)</span>.</p>
<pre><code>fplot([x^2, x^3],[-3,3])</code></pre>
<p>The result is:</p>
<figure>
<img src="images/ch02/plot06.png" alt="Plots of multiple functions on the same axes" /><figcaption aria-hidden="true">Plots of multiple functions on the same axes</figcaption>
</figure>
<h3 id="adding-a-legend">Adding a Legend</h3>
<p>A legend is important for any plot containing more than one function. This allows you to distinguish between the curves. There is a legend option to the plot function. For example, to add a legend and a title to the plot of <span class="math inline">\(x^{2}\)</span> and <span class="math inline">\(x^{3}\)</span> type:</p>
<pre><code>fplot([x^2 x^3], [-3,3])
title(&quot;A plot of x^2 and x^3&quot;)
legend(&quot;x^2&quot;,&quot;x^3&quot;)</code></pre>
<p>and you will see: <img src="images/ch02/plot07.png" alt="A plot of two functions with a legend" /></p>
<h3 id="exercise-1">Exercise</h3>
<p>Graph the functions <span class="math inline">\(\sin x, \sin 2x,\)</span> and <span class="math inline">\(2 \sin x\)</span> on the same coordinate axis. Label your graphs using the legend, and change your plot range to <span class="math inline">\(−2\pi \leq x \leq 2\pi\)</span> and <span class="math inline">\(−2.5 \leq y \leq 2.5\)</span>.</p>
<p>Hint: see above on getting multiples of <span class="math inline">\(\pi/2\)</span> for you <span class="math inline">\(x\)</span> tick marks.</p>
<h2 id="changing-the-aspect-ratio-of-a-plot">Changing the Aspect Ratio of a Plot</h2>
<p>Recall that the function <span class="math inline">\(f(x)=\sqrt{4-x^2}\)</span> is the top half of a circle. If we plot this with</p>
<pre><code>fplot(sqrt(4-x^2),[-2 2])</code></pre>
<p>we’ll get the following plot: <img src="images/ch02/plot08.png" alt="A plot the top half of a circle" /></p>
<p>and this just doesn’t look like a circle. This is because the aspect ratio isn’t 1–this means that 1 unit in the x-direction and 1 unit in the y-direction are not equal.</p>
<p>We can do that in Matlab with the following:</p>
<pre><code>fplot(sqrt(4-x^2),[-2 2])
daspect([1 1 1])</code></pre>
<p>and the result is: <img src="images/ch02/plot09.png" alt="A plot the top half of a circle" /></p>
<p>Note: there are three numbers here because we will see 3D plots need can have different aspects as well. Matlab does this in general by ensuring that it know the relative sizes of all three axes.</p>
<h3 id="exercise-2">Exercise</h3>
<p>Plot the functions <span class="math inline">\(f(x)=2x+3\)</span> and <span class="math inline">\(g(x)=-\frac{1}{2}x+1\)</span> and make the plot ratio 1:1. The two lines should be perpendicular. (Why?)</p>
<h2 id="plotting-a-function-with-a-parameter">Plotting a function with a parameter</h2>
<p>Maple is also helpful in understanding how a parameter (a variable that just takes on certain values) affects a plot. For example, if we plot <span class="math inline">\(y=x^2+C\)</span> for <span class="math inline">\(C=-2,-1,0,1,2\)</span> and we want to see what happens to the plot.</p>
<p>To make this easier, we first define the functions:</p>
<pre><code>curves=[x^2-2,x^2-1,x^2,x^2+1,x^2+2]</code></pre>
<p>then plot the results and add a legend:</p>
<pre><code>curves=[x^2-2,x^2-1,x^2,x^2+1,x^2+2]
fplot(curves)
title(&quot;The family of curves x^2+C&quot;)
legend(&quot;C=-2&quot;,&quot;C=-1&quot;,&quot;C=0&quot;,&quot;C=1&quot;,&quot;C=2&quot;)</code></pre>
<p>the result will be:</p>
<figure>
<img src="images/ch02/plot10.png" alt="Plot of a family of lines" /><figcaption aria-hidden="true">Plot of a family of lines</figcaption>
</figure>
<p>And from this you can see that the parameter C shifts the lines vertically.</p>
<h2 id="piecewise-functions">Piecewise Functions</h2>
<p>Another common plot is that of a piecewise function, consider <span class="math display">\[f(x) = \begin{cases} x &amp; x&lt;0 \\ 3-x^{2} &amp; x \geq 0 \end{cases}\]</span></p>
<p>We will see a way to create functions like this later in the course, but here we will plot them. Recall that what this means is that the function <span class="math inline">\(f\)</span> takes on the values of <span class="math inline">\(x\)</span> when <span class="math inline">\(x&lt;0\)</span> and when <span class="math inline">\(x \geq 0\)</span>, then it has the functional form <span class="math inline">\(3-x^2\)</span>. We wil plot this by creating a plot with two different curves on it.</p>
<p>The way to enter this in is the following:</p>
<pre><code>f(x) = piecewise(x&lt;0,x,x&gt;=0,3-x^2)
fplot(f(x), [-3 3])</code></pre>
<p>and this results in the following plot: <img src="images/ch02/plot11.png" alt="Plot of a piecewise function" /></p>
<p>The vertical line connecting (0,0) with (0,3) is not part of the plot. Matlab simply just connects a bunch of points. Sometimes it seems that it can figure out that it’s not part of the plot. Unfortunately, if it doesn’t automatically remove the line, you need to do something different.</p>
<pre><code>fplot(f(x),[0,3])
hold on
fplot(f(x),[-3,-0.0001])
hold off</code></pre>
<p>results in</p>
<figure>
<img src="images/ch02/plot12.png" alt="Improved plot of a piecewise function" /><figcaption aria-hidden="true">Improved plot of a piecewise function</figcaption>
</figure>
<p>which is better but it looks like two different curves becaues the two pieces are different colors. We can set them both to be the same color with:</p>
<pre><code>fplot(f(x),[0,3],&#39;blue&#39;)
hold on
fplot(f(x),[-3,-0.0001],&#39;blue&#39;)
hold off</code></pre>
<figure>
<img src="images/ch02/plot13.png" alt="Improved plot of a piecewise function" /><figcaption aria-hidden="true">Improved plot of a piecewise function</figcaption>
</figure>
<h4 id="exercise-3">Exercise</h4>
<p>Plot the piecewise function:</p>
<p><span class="math display">\[
    f(x) = \begin{cases}
    1-(x-\pi/2)^2 &amp; x &gt; \frac{\pi}{2} \\
    1 &amp; -\frac{\pi}{2} \leq x \leq \frac{\pi}{2} \\
    \sin x &amp; x &lt; -\frac{\pi}{2} \\
    \end{cases}
\]</span></p>
<h2 id="plotting-functions-with-discontinuities">Plotting Functions with discontinuities</h2>
<p>Although Matlab doesn’t often pick up on jump discontinuities from piecewise functions, it does to well with other types. Consider:</p>
<pre><code>fplot(1/(x-1),[-3,3])</code></pre>
<p>which has the result:</p>
<figure>
<img src="images/ch02/plot14.png" alt="plot of 1/(x-1)" /><figcaption aria-hidden="true">plot of 1/(x-1)</figcaption>
</figure>
<p>The vertical dashed line is a vertical asymptote in this case.</p>
<h4 id="exercise-4">Exercise</h4>
<p>Plot <span class="math inline">\(f(x) = \tan(x)\)</span> on <span class="math inline">\([-3\pi,3\pi]\)</span> and use multiples of <span class="math inline">\(\pi/2\)</span> for the horizontal labels. Hint: see above to do this. Does Matlab correctly pick up the vertical asymptotes in this case?</p>
<h2 id="scatter-plots">Scatter Plots</h2>
<p>A scatter plot is a set of points plotted in the <span class="math inline">\(xy\)</span>-plane. Consider the points <span class="math inline">\((0,1),(1,0),(2,1),(3,0)\)</span>. We will see how to plot this.</p>
<p>For this, we create a vectors of the x points and y points:</p>
<pre><code>x=[0,1,2,3]
y=[1,0,1,0]</code></pre>
<p>and the call the function <code>scatter</code>:</p>
<pre><code>scatter(x,y)</code></pre>
<p>resulting in</p>
<figure>
<img src="images/ch02/plot15.png" alt="Example of a scatter plot" /><figcaption aria-hidden="true">Example of a scatter plot</figcaption>
</figure>
<h4 id="exercise-5">Exercise</h4>
<ol type="1">
<li>Search for <code>scatter</code> in the help documentation. There is a number of ways to change the size, shaped and color of the dots.</li>
<li>Create a plot that looks like:</li>
</ol>
<figure>
<img src="images/ch02/plot16.png" alt="line and point plot" /><figcaption aria-hidden="true">line and point plot</figcaption>
</figure>
<p>At the bottom of the <code>scatter</code> documentation has all of the options.</p>
<h2 id="combining-scatter-and-function-plots">Combining Scatter and Function Plots</h2>
<p>We can combine a scatter and function plots using the <code>hold</code> command. Let’s say we have the points: (0,10),(2,9),(3,7),(5,6),(7,4),(8,2) and we wish to plot a best fit line as well. First, let’s define the points</p>
<pre><code>x = [0,2,3,5,7,8];
y = [10,9,7,6,4,2];</code></pre>
<p>Later we will show how to get a best-fit line</p>
<pre><code>scatter(x,y,100,&#39;blue&#39;,&#39;filled&#39;);
hold on
fplot(@(x) 10.8665-0.9680*x,[-0.5,9])
hold off</code></pre>
<p>This will produce a plot that looks like:</p>
<figure>
<img src="images/ch02/plot17.png" alt="Plot with functions and dots" /><figcaption aria-hidden="true">Plot with functions and dots</figcaption>
</figure>
</body>
</html>
